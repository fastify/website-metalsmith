<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>TypeScript</title><meta name=description content="Fast and low overhead web framework, for Node.js"><link rel=apple-touch-icon sizes=57x57 href=/images/apple-icon-57x57.ed24c0a19503e080.png><link rel=apple-touch-icon sizes=60x60 href=/images/apple-icon-60x60.60c285c424d50738.png><link rel=apple-touch-icon sizes=72x72 href=/images/apple-icon-72x72.e49b27cfe1ab1461.png><link rel=apple-touch-icon sizes=76x76 href=/images/apple-icon-76x76.752f43fc91b8c1f7.png><link rel=apple-touch-icon sizes=114x114 href=/images/apple-icon-114x114.61739fa1d5a7059a.png><link rel=apple-touch-icon sizes=120x120 href=/images/apple-icon-120x120.7c25de37c5ce2ec1.png><link rel=apple-touch-icon sizes=144x144 href=/images/apple-icon-144x144.04d88fb27bd92cbe.png><link rel=apple-touch-icon sizes=152x152 href=/images/apple-icon-152x152.9364781175671626.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-icon-180x180.67579100928bfcd2.png><link rel=icon type=image/png sizes=192x192 href=/images/android-icon-192x192.37eb7f1ae3853740.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32.1e22f0e774bc3cce.png><link rel=icon type=image/png sizes=96x96 href=/images/favicon-96x96.7e8a68b1b80c1799.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16.e534ce05cb727f1a.png><link rel=manifest href=/manifest.json><meta name=msapplication-TileColor content=#ffffff><meta name=msapplication-TileImage content=/images/ms-icon-144x144.png><meta name=theme-color content=#ffffff><meta property=og:url content=https://www.fastify.io/docs/v4.6.x/Reference/TypeScript><meta property=og:type content=website><meta property=og:title content=TypeScript><meta property=og:description content="Fast and low overhead web framework, for Node.js"><meta property=og:image content=https://www.fastify.io/images/fastify-fb-share-image.07b6e6860853c758.png><meta name=twitter:card content=summary_large_image><meta name=twitter:site content=@fastifyjs><meta name=twitter:creator content=@fastifyjs><meta name=twitter:title content=TypeScript><meta name=twitter:description content="Fast and low overhead web framework, for Node.js"><meta name=twitter:image content=https://www.fastify.io/images/fastify-twitter-share-image.cd9f217b360af3e2.png><link rel=stylesheet href=/css/style.f4d6592b3a91c5ef.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/default.min.css integrity="sha512-kZqGbhf9JTB4bVJ0G8HCkqmaPcRgo88F0dneK30yku5Y/dep7CZfCnNml2Je/sY4lBoqoksXz4PtVXS4GHSUzQ==" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@alpha><meta name=robots content="noindex, nofollow"></head><body><nav id=main-navbar class=navbar><div class=navbar-brand><a class=navbar-item href=/ ><img src=/images/fastify-logo-menu.d13f8da7a965c800.png alt="Fastify: Fast and low overhead web framework, for Node.js" height=28 decoding=async> </a><a class="navbar-item is-hidden-desktop" href=https://github.com/fastify/fastify target=_blank rel=noopener><span class=icon style="color: #333;"><i class="fa fa-github"></i></span></a><div class="navbar-burger burger" data-target=mobileMenu><span></span> <span></span> <span></span></div></div><div class=navbar-menu id=mobileMenu><div class=navbar-start><a class=navbar-item href=/ >Home</a> <a class=navbar-item href=/docs/latest>Docs</a> <a class=navbar-item href=/ecosystem>Ecosystem</a> <a class=navbar-item href=/benchmarks>Benchmarks</a> <a class=navbar-item href=/contribute>Contribute</a> <a class=navbar-item href=https://medium.com/@fastifyjs/ >Blog</a> <a class=navbar-item href=https://github.com/fastify/help>Help</a></div><div class=navbar-end><span id=algolia-search-input class="control has-icons-left navbar-item"></span> <a class=navbar-item href=https://github.com/fastify/fastify target=_blank rel=noopener><span class="fa fa-github"></span>&nbsp;GitHub </a><a class=navbar-item href=https://twitter.com/fastifyjs target=_blank rel=noopener><span class="fa fa-twitter"></span>&nbsp;Twitter </a><a class=navbar-item rel=me href=https://fosstodon.org/@fastify target=_blank><span class="fa fa-hashtag"></span>&nbsp;Mastodon</a></div></div></nav><main class=page-content aria-label=Content><section class="hero is-primary" style="background-image: url(/images/bg-pattern-dark.3f8cda863b3bbf52.png)"><div class=hero-body><div class=container><h1 class=title>Documentation (v4.6.0)</h1></div></div></section><section class=section><div class=container><div class=columns><div class="column is-3 is-hidden-mobile sticky-container"><aside class="menu sticky" id=toc><ul class=menu-list></ul><p class=menu-label><a href=/docs/v4.6.x/Guides>Guides</a></p><ul class=menu-list><li style="text-transform: capitalize"><a title=Benchmarking href=/docs/v4.6.x/Guides/Benchmarking>Benchmarking</a></li><li style="text-transform: capitalize"><a title=Contributing href=/docs/v4.6.x/Guides/Contributing>Contributing</a></li><li style="text-transform: capitalize"><a title=Database href=/docs/v4.6.x/Guides/Database>Database</a></li><li style="text-transform: capitalize"><a title=Delay-Accepting-Requests href=/docs/v4.6.x/Guides/Delay-Accepting-Requests>Delay-Accepting-Requests</a></li><li style="text-transform: capitalize"><a title=Ecosystem href=/docs/v4.6.x/Guides/Ecosystem>Ecosystem</a></li><li style="text-transform: capitalize"><a title=Fluent-Schema href=/docs/v4.6.x/Guides/Fluent-Schema>Fluent-Schema</a></li><li style="text-transform: capitalize"><a title=Getting-Started href=/docs/v4.6.x/Guides/Getting-Started>Getting-Started</a></li><li style="text-transform: capitalize"><a title=Migration-Guide-V3 href=/docs/v4.6.x/Guides/Migration-Guide-V3>Migration-Guide-V3</a></li><li style="text-transform: capitalize"><a title=Migration-Guide-V4 href=/docs/v4.6.x/Guides/Migration-Guide-V4>Migration-Guide-V4</a></li><li style="text-transform: capitalize"><a title=Plugins-Guide href=/docs/v4.6.x/Guides/Plugins-Guide>Plugins-Guide</a></li><li style="text-transform: capitalize"><a title=Prototype-Poisoning href=/docs/v4.6.x/Guides/Prototype-Poisoning>Prototype-Poisoning</a></li><li style="text-transform: capitalize"><a title=Recommendations href=/docs/v4.6.x/Guides/Recommendations>Recommendations</a></li><li style="text-transform: capitalize"><a title=Serverless href=/docs/v4.6.x/Guides/Serverless>Serverless</a></li><li style="text-transform: capitalize"><a title=Style-Guide href=/docs/v4.6.x/Guides/Style-Guide>Style-Guide</a></li><li style="text-transform: capitalize"><a title=Testing href=/docs/v4.6.x/Guides/Testing>Testing</a></li><li style="text-transform: capitalize"><a title=Write-Plugin href=/docs/v4.6.x/Guides/Write-Plugin>Write-Plugin</a></li></ul><p class=menu-label><a href=/docs/v4.6.x/Reference>Reference</a></p><ul class=menu-list><li style="text-transform: capitalize"><a title=ContentTypeParser href=/docs/v4.6.x/Reference/ContentTypeParser>ContentTypeParser</a></li><li style="text-transform: capitalize"><a title=Decorators href=/docs/v4.6.x/Reference/Decorators>Decorators</a></li><li style="text-transform: capitalize"><a title=Encapsulation href=/docs/v4.6.x/Reference/Encapsulation>Encapsulation</a></li><li style="text-transform: capitalize"><a title=Errors href=/docs/v4.6.x/Reference/Errors>Errors</a></li><li style="text-transform: capitalize"><a title=HTTP2 href=/docs/v4.6.x/Reference/HTTP2>HTTP2</a></li><li style="text-transform: capitalize"><a title=Hooks href=/docs/v4.6.x/Reference/Hooks>Hooks</a></li><li style="text-transform: capitalize"><a title=LTS href=/docs/v4.6.x/Reference/LTS>LTS</a></li><li style="text-transform: capitalize"><a title=Lifecycle href=/docs/v4.6.x/Reference/Lifecycle>Lifecycle</a></li><li style="text-transform: capitalize"><a title=Logging href=/docs/v4.6.x/Reference/Logging>Logging</a></li><li style="text-transform: capitalize"><a title=Middleware href=/docs/v4.6.x/Reference/Middleware>Middleware</a></li><li style="text-transform: capitalize"><a title=Plugins href=/docs/v4.6.x/Reference/Plugins>Plugins</a></li><li style="text-transform: capitalize"><a title=Reply href=/docs/v4.6.x/Reference/Reply>Reply</a></li><li style="text-transform: capitalize"><a title=Request href=/docs/v4.6.x/Reference/Request>Request</a></li><li style="text-transform: capitalize"><a title=Routes href=/docs/v4.6.x/Reference/Routes>Routes</a></li><li style="text-transform: capitalize"><a title=Server href=/docs/v4.6.x/Reference/Server>Server</a></li><li style="text-transform: capitalize"><a title=Type-Providers href=/docs/v4.6.x/Reference/Type-Providers>Type-Providers</a></li><li style="text-transform: capitalize" id=doc-menu-section><a title=TypeScript class=is-active href=/docs/v4.6.x/Reference/TypeScript>TypeScript</a></li><li style="text-transform: capitalize"><a title=Validation-and-Serialization href=/docs/v4.6.x/Reference/Validation-and-Serialization>Validation-and-Serialization</a></li></ul><div class=content style="margin: .8em; border-top: 1px solid #ccc; padding: .8em 0 0 0">Docs version<div class=field><div class=control><div class=select><select onchange="if (this.value) window.location.href=this.value"><option value=/docs/latest>latest</option><option value=/docs/master>master</option><option value=/docs/v4.10.x>v4.10.x</option><option value=/docs/v4.9.x>v4.9.x</option><option value=/docs/v4.8.x>v4.8.x</option><option value=/docs/v4.7.x>v4.7.x</option><option selected value=/docs/v4.6.x>v4.6.x</option><option value=/docs/v4.5.x>v4.5.x</option><option value=/docs/v4.4.x>v4.4.x</option><option value=/docs/v4.3.x>v4.3.x</option><option value=/docs/v4.2.x>v4.2.x</option><option value=/docs/v4.1.x>v4.1.x</option><option value=/docs/v4.0.x>v4.0.x</option><option value=/docs/v3.29.x>v3.29.x</option><option value=/docs/v3.28.x>v3.28.x</option><option value=/docs/v3.27.x>v3.27.x</option><option value=/docs/v3.26.x>v3.26.x</option><option value=/docs/v3.25.x>v3.25.x</option><option value=/docs/v3.24.x>v3.24.x</option><option value=/docs/v3.23.x>v3.23.x</option><option value=/docs/v3.22.x>v3.22.x</option><option value=/docs/v3.21.x>v3.21.x</option><option value=/docs/v3.20.x>v3.20.x</option><option value=/docs/v3.19.x>v3.19.x</option><option value=/docs/v3.18.x>v3.18.x</option><option value=/docs/v3.17.x>v3.17.x</option><option value=/docs/v3.16.x>v3.16.x</option><option value=/docs/v3.15.x>v3.15.x</option><option value=/docs/v3.14.x>v3.14.x</option><option value=/docs/v3.13.x>v3.13.x</option><option value=/docs/v3.12.x>v3.12.x</option><option value=/docs/v3.11.x>v3.11.x</option><option value=/docs/v3.10.x>v3.10.x</option><option value=/docs/v3.9.x>v3.9.x</option><option value=/docs/v3.8.x>v3.8.x</option><option value=/docs/v3.7.x>v3.7.x</option><option value=/docs/v3.6.x>v3.6.x</option><option value=/docs/v3.5.x>v3.5.x</option><option value=/docs/v3.4.x>v3.4.x</option><option value=/docs/v3.3.x>v3.3.x</option><option value=/docs/v3.2.x>v3.2.x</option><option value=/docs/v3.1.x>v3.1.x</option><option value=/docs/v3.0.x>v3.0.x</option><option value=/docs/v2.15.x>v2.15.x</option><option value=/docs/v2.14.x>v2.14.x</option><option value=/docs/v2.13.x>v2.13.x</option><option value=/docs/v2.12.x>v2.12.x</option><option value=/docs/v2.11.x>v2.11.x</option><option value=/docs/v2.10.x>v2.10.x</option><option value=/docs/v2.9.x>v2.9.x</option><option value=/docs/v2.8.x>v2.8.x</option><option value=/docs/v2.7.x>v2.7.x</option><option value=/docs/v2.6.x>v2.6.x</option><option value=/docs/v2.5.x>v2.5.x</option><option value=/docs/v2.4.x>v2.4.x</option><option value=/docs/v2.3.x>v2.3.x</option><option value=/docs/v2.2.x>v2.2.x</option><option value=/docs/v2.1.x>v2.1.x</option><option value=/docs/v2.0.x>v2.0.x</option><option value=/docs/v1.14.x>v1.14.x</option><option value=/docs/v1.13.x>v1.13.x</option></select></div></div></div></div></aside></div><div class="column is-9"><nav class=breadcrumb><ul><li><a href=/ style="padding-left: 0">Fastify</a></li><li><a href=/docs/v4.6.x>Documentation</a></li><li><div class=field><div class=control><div class=select><select onchange="if (this.value) window.location.href=this.value" style="border: none;"><option value=/docs/latest>latest</option><option value=/docs/master>master</option><option value=/docs/v4.10.x>v4.10.x</option><option value=/docs/v4.9.x>v4.9.x</option><option value=/docs/v4.8.x>v4.8.x</option><option value=/docs/v4.7.x>v4.7.x</option><option selected value=/docs/v4.6.x>v4.6.x</option><option value=/docs/v4.5.x>v4.5.x</option><option value=/docs/v4.4.x>v4.4.x</option><option value=/docs/v4.3.x>v4.3.x</option><option value=/docs/v4.2.x>v4.2.x</option><option value=/docs/v4.1.x>v4.1.x</option><option value=/docs/v4.0.x>v4.0.x</option><option value=/docs/v3.29.x>v3.29.x</option><option value=/docs/v3.28.x>v3.28.x</option><option value=/docs/v3.27.x>v3.27.x</option><option value=/docs/v3.26.x>v3.26.x</option><option value=/docs/v3.25.x>v3.25.x</option><option value=/docs/v3.24.x>v3.24.x</option><option value=/docs/v3.23.x>v3.23.x</option><option value=/docs/v3.22.x>v3.22.x</option><option value=/docs/v3.21.x>v3.21.x</option><option value=/docs/v3.20.x>v3.20.x</option><option value=/docs/v3.19.x>v3.19.x</option><option value=/docs/v3.18.x>v3.18.x</option><option value=/docs/v3.17.x>v3.17.x</option><option value=/docs/v3.16.x>v3.16.x</option><option value=/docs/v3.15.x>v3.15.x</option><option value=/docs/v3.14.x>v3.14.x</option><option value=/docs/v3.13.x>v3.13.x</option><option value=/docs/v3.12.x>v3.12.x</option><option value=/docs/v3.11.x>v3.11.x</option><option value=/docs/v3.10.x>v3.10.x</option><option value=/docs/v3.9.x>v3.9.x</option><option value=/docs/v3.8.x>v3.8.x</option><option value=/docs/v3.7.x>v3.7.x</option><option value=/docs/v3.6.x>v3.6.x</option><option value=/docs/v3.5.x>v3.5.x</option><option value=/docs/v3.4.x>v3.4.x</option><option value=/docs/v3.3.x>v3.3.x</option><option value=/docs/v3.2.x>v3.2.x</option><option value=/docs/v3.1.x>v3.1.x</option><option value=/docs/v3.0.x>v3.0.x</option><option value=/docs/v2.15.x>v2.15.x</option><option value=/docs/v2.14.x>v2.14.x</option><option value=/docs/v2.13.x>v2.13.x</option><option value=/docs/v2.12.x>v2.12.x</option><option value=/docs/v2.11.x>v2.11.x</option><option value=/docs/v2.10.x>v2.10.x</option><option value=/docs/v2.9.x>v2.9.x</option><option value=/docs/v2.8.x>v2.8.x</option><option value=/docs/v2.7.x>v2.7.x</option><option value=/docs/v2.6.x>v2.6.x</option><option value=/docs/v2.5.x>v2.5.x</option><option value=/docs/v2.4.x>v2.4.x</option><option value=/docs/v2.3.x>v2.3.x</option><option value=/docs/v2.2.x>v2.2.x</option><option value=/docs/v2.1.x>v2.1.x</option><option value=/docs/v2.0.x>v2.0.x</option><option value=/docs/v1.14.x>v1.14.x</option><option value=/docs/v1.13.x>v1.13.x</option></select></div></div></div></li><div class=field><div class=control><div class=select><select onchange="if (this.value) window.location.href=this.value" style="border: none;"><option value=/docs/v4.6.x>Documentation</option><option value=/docs/v4.6.x/Guides>Guides</option><option value=/docs/v4.6.x/Guides/Benchmarking>Benchmarking</option><option value=/docs/v4.6.x/Guides/Contributing>Contributing</option><option value=/docs/v4.6.x/Guides/Database>Database</option><option value=/docs/v4.6.x/Guides/Delay-Accepting-Requests>Delay-Accepting-Requests</option><option value=/docs/v4.6.x/Guides/Ecosystem>Ecosystem</option><option value=/docs/v4.6.x/Guides/Fluent-Schema>Fluent-Schema</option><option value=/docs/v4.6.x/Guides/Getting-Started>Getting-Started</option><option value=/docs/v4.6.x/Guides/Migration-Guide-V3>Migration-Guide-V3</option><option value=/docs/v4.6.x/Guides/Migration-Guide-V4>Migration-Guide-V4</option><option value=/docs/v4.6.x/Guides/Plugins-Guide>Plugins-Guide</option><option value=/docs/v4.6.x/Guides/Prototype-Poisoning>Prototype-Poisoning</option><option value=/docs/v4.6.x/Guides/Recommendations>Recommendations</option><option value=/docs/v4.6.x/Guides/Serverless>Serverless</option><option value=/docs/v4.6.x/Guides/Style-Guide>Style-Guide</option><option value=/docs/v4.6.x/Guides/Testing>Testing</option><option value=/docs/v4.6.x/Guides/Write-Plugin>Write-Plugin</option><option value=/docs/v4.6.x/Reference>Reference</option><option value=/docs/v4.6.x/Reference/ContentTypeParser>ContentTypeParser</option><option value=/docs/v4.6.x/Reference/Decorators>Decorators</option><option value=/docs/v4.6.x/Reference/Encapsulation>Encapsulation</option><option value=/docs/v4.6.x/Reference/Errors>Errors</option><option value=/docs/v4.6.x/Reference/HTTP2>HTTP2</option><option value=/docs/v4.6.x/Reference/Hooks>Hooks</option><option value=/docs/v4.6.x/Reference/LTS>LTS</option><option value=/docs/v4.6.x/Reference/Lifecycle>Lifecycle</option><option value=/docs/v4.6.x/Reference/Logging>Logging</option><option value=/docs/v4.6.x/Reference/Middleware>Middleware</option><option value=/docs/v4.6.x/Reference/Plugins>Plugins</option><option value=/docs/v4.6.x/Reference/Reply>Reply</option><option value=/docs/v4.6.x/Reference/Request>Request</option><option value=/docs/v4.6.x/Reference/Routes>Routes</option><option value=/docs/v4.6.x/Reference/Server>Server</option><option value=/docs/v4.6.x/Reference/Type-Providers>Type-Providers</option><option selected value=/docs/v4.6.x/Reference/TypeScript>TypeScript</option><option value=/docs/v4.6.x/Reference/Validation-and-Serialization>Validation-and-Serialization</option></select></div></div></div></ul></nav><div id=doc-content class=content><h2 id=typescript>TypeScript</h2><p>The Fastify framework is written in vanilla JavaScript, and as such type definitions are not as easy to maintain; however, since version 2 and beyond, maintainers and contributors have put in a great effort to improve the types.</p><p>The type system was changed in Fastify version 3. The new type system introduces generic constraining and defaulting, plus a new way to define schema types such as a request body, querystring, and more! As the team works on improving framework and type definition synergy, sometimes parts of the API will not be typed or may be typed incorrectly. We encourage you to <strong>contribute</strong> to help us fill in the gaps. Just make sure to read our <a href=https://github.com/fastify/fastify/blob/main/CONTRIBUTING.md><code>CONTRIBUTING.md</code></a> file before getting started to make sure things go smoothly!</p><blockquote><p>The documentation in this section covers Fastify version 3.x typings</p></blockquote><blockquote><p>Plugins may or may not include typings. See <a href=#plugins>Plugins</a> for more information. We encourage users to send pull requests to improve typings support.</p></blockquote><p>🚨 Don&#39;t forget to install <code>@types/node</code></p><h2 id=learn-by-example>Learn By Example</h2><p>The best way to learn the Fastify type system is by example! The following four examples should cover the most common Fastify development cases. After the examples there is further, more detailed documentation for the type system.</p><h3 id=getting-started>Getting Started</h3><p>This example will get you up and running with Fastify and TypeScript. It results in a blank http Fastify server.</p><ol><li>Create a new npm project, install Fastify, and install typescript &amp; node.js types as peer dependencies:</li></ol><pre><code class=language-bash>npm init -y
npm i fastify
npm i -D typescript @types/node
</code></pre><ol start=2><li>Add the following lines to the <code>&quot;scripts&quot;</code> section of the <code>package.json</code>:</li></ol><pre><code class=language-json>{
  &quot;scripts&quot;: {
    &quot;build&quot;: &quot;tsc -p tsconfig.json&quot;,
    &quot;start&quot;: &quot;node index.js&quot;
  }
}
</code></pre><ol start=3><li>Initialize a TypeScript configuration file:</li></ol><pre><code class=language-bash>npx tsc --init
</code></pre><p>or use one of the <a href=https://github.com/tsconfig/bases#node-14-tsconfigjson>recommended ones</a>.</p><p><em>Note: Set <code>target</code> property in <code>tsconfig.json</code> to <code>es2017</code> or greater to avoid <a href=https://github.com/fastify/fastify/issues/3284>FastifyDeprecation</a> warning.</em></p><p><em>Note 2: Avoid using <code>&quot;moduleResolution&quot;: &quot;NodeNext&quot;</code> in tsconfig.json with <code>&quot;type&quot;: &quot;module&quot;</code> in package.json. This combination is currently not supported by fastify typing system. <a href=https://github.com/fastify/fastify/issues/4241>ts(2349)</a> warning.</em></p><ol start=4><li>Create an <code>index.ts</code> file - this will contain the server code</li><li>Add the following code block to your file:<pre><code class=language-typescript>import fastify from &#39;fastify&#39;

const server = fastify()

server.get(&#39;/ping&#39;, async (request, reply) =&gt; {
  return &#39;pong\n&#39;
})

server.listen({ port: 8080 }, (err, address) =&gt; {
  if (err) {
    console.error(err)
    process.exit(1)
  }
  console.log(`Server listening at ${address}`)
})
</code></pre></li><li>Run <code>npm run build</code> - this will compile <code>index.ts</code> into <code>index.js</code> which can be executed using Node.js. If you run into any errors please open an issue in <a href=https://github.com/fastify/help/ >fastify/help</a></li><li>Run <code>npm run start</code> to run the Fastify server</li><li>You should see <code>Server listening at http://127.0.0.1:8080</code> in your console</li><li>Try out your server using <code>curl localhost:8080/ping</code>, it should return <code>pong</code> 🏓</li></ol><p>🎉 You now have a working Typescript Fastify server! This example demonstrates the simplicity of the version 3.x type system. By default, the type system assumes you are using an <code>http</code> server. The later examples will demonstrate how to create more complex servers such as <code>https</code> and <code>http2</code>, how to specify route schemas, and more!</p><blockquote><p>For more examples on initializing Fastify with TypeScript (such as enabling HTTP2) check out the detailed API section <a href=#fastifyrawserver-rawrequest-rawreply-loggeropts-fastifyserveroptions-fastifyinstance>here</a></p></blockquote><h3 id=using-generics>Using Generics</h3><p>The type system heavily relies on generic properties to provide the most accurate development experience. While some may find the overhead a bit cumbersome, the tradeoff is worth it! This example will dive into implementing generic types for route schemas and the dynamic properties located on the route-level <code>request</code> object.</p><ol><li><p>If you did not complete the previous example, follow steps 1-4 to get set up.</p></li><li><p>Inside <code>index.ts</code>, define two interfaces <code>IQuerystring</code> and <code>IHeaders</code>:</p><pre><code class=language-typescript>interface IQuerystring {
  username: string;
  password: string;
}

interface IHeaders {
  &#39;h-Custom&#39;: string;
}
</code></pre></li><li><p>Using the two interfaces, define a new API route and pass them as generics. The shorthand route methods (i.e. <code>.get</code>) accept a generic object <code>RouteGenericInterface</code> containing five named properties: <code>Body</code>, <code>Querystring</code>, <code>Params</code>, <code>Headers</code> and <code>Reply</code>. The interfaces <code>Body</code>, <code>Querystring</code>, <code>Params</code> and <code>Headers</code> will be passed down through the route method into the route method handler <code>request</code> instance and the <code>Reply</code> interface to the <code>reply</code> instance.</p><pre><code class=language-typescript>server.get&lt;{
  Querystring: IQuerystring,
  Headers: IHeaders
}&gt;(&#39;/auth&#39;, async (request, reply) =&gt; {
  const { username, password } = request.query
  const customerHeader = request.headers[&#39;h-Custom&#39;]
  // do something with request data

  return `logged in!`
})
</code></pre></li><li><p>Build and run the server code with <code>npm run build</code> and <code>npm run start</code></p></li><li><p>Query the api</p><pre><code class=language-bash>curl localhost:8080/auth?username=admin&amp;password=Password123!
</code></pre><p>And it should return back <code>logged in!</code></p></li><li><p>But wait there&#39;s more! The generic interfaces are also available inside route level hook methods. Modify the previous route by adding a <code>preValidation</code> hook:</p><pre><code class=language-typescript>server.get&lt;{
  Querystring: IQuerystring,
  Headers: IHeaders
}&gt;(&#39;/auth&#39;, {
  preValidation: (request, reply, done) =&gt; {
    const { username, password } = request.query
    done(username !== &#39;admin&#39; ? new Error(&#39;Must be admin&#39;) : undefined) // only validate `admin` account
  }
}, async (request, reply) =&gt; {
  const customerHeader = request.headers[&#39;h-Custom&#39;]
  // do something with request data
  return `logged in!`
})
</code></pre></li><li><p>Build and run and query with the <code>username</code> query string option set to anything other than <code>admin</code>. The API should now return a HTTP 500 error <code>{&quot;statusCode&quot;:500,&quot;error&quot;:&quot;Internal Server Error&quot;,&quot;message&quot;:&quot;Must be admin&quot;}</code></p></li></ol><p>🎉 Good work, now you can define interfaces for each route and have strictly typed request and reply instances. Other parts of the Fastify type system rely on generic properties. Make sure to reference the detailed type system documentation below to learn more about what is available.</p><h3 id=json-schema>JSON Schema</h3><p>To validate your requests and responses you can use JSON Schema files. If you didn&#39;t know already, defining schemas for your Fastify routes can increase their throughput! Check out the <a href=.././Validation-and-Serialization>Validation and Serialization</a> documentation for more info.</p><p>Also it has the advantage to use the defined type within your handlers (including pre-validation, etc.).</p><p>Here are some options how to achieve this.</p><h4 id=fastify-type-providers>Fastify Type Providers</h4><p>Fastify offers two packages wrapping <code>json-schema-to-ts</code> and <code>typebox</code>:</p><ul><li><code>@fastify/type-provider-json-schema-to-ts</code></li><li><code>@fastify/type-provider-typebox</code></li></ul><p>They simplify schema validation setup and you can read more about them in <a href=.././Type-Providers>Type Providers</a> page.</p><p>Below is how to setup schema validation using vanilla <code>typebox</code> and <code>json-schema-to-ts</code> packages.</p><h4 id=typebox>typebox</h4><p>A useful library for building types and a schema at once is <a href=https://www.npmjs.com/package/@sinclair/typebox>typebox</a> along with <a href=https://github.com/fastify/fastify-type-provider-typebox>fastify-type-provider-typebox</a>. With typebox you define your schema within your code and use them directly as types or schemas as you need them.</p><p>When you want to use it for validation of some payload in a fastify route you can do it as follows:</p><ol><li><p>Install <code>typebox</code> and <code>fastify-type-provider-typebox</code> in your project.</p><pre><code class=language-bash>npm i @sinclair/typebox @fastify/type-provider-typebox
</code></pre></li><li><p>Define the schema you need with <code>Type</code> and create the respective type with <code>Static</code>.</p><pre><code class=language-typescript>import { Static, Type } from &#39;@sinclair/typebox&#39;

export const User = Type.Object({
  name: Type.String(),
  mail: Type.Optional(Type.String({ format: &#39;email&#39; })),
})

export type UserType = Static&lt;typeof User&gt;
</code></pre></li><li><p>Use the defined type and schema during the definition of your route</p><pre><code class=language-typescript>import Fastify from &#39;fastify&#39;
import { TypeBoxTypeProvider } from &#39;@fastify/type-provider-typebox&#39;
// ...

const fastify = Fastify().withTypeProvider&lt;TypeBoxTypeProvider&gt;()

app.post&lt;{ Body: UserType, Reply: UserType }&gt;(
  &#39;/&#39;,
  {
    schema: {
      body: User,
      response: {
        200: User
      },
    },
  },
  (request, reply) =&gt; {
    // The `name` and `mail` types are automatically inferred
    const { name, mail } = request.body;
    reply.status(200).send({ name, mail });
  }
)
</code></pre></li></ol><h4 id=schemas-in-json-files>Schemas in JSON Files</h4><p>In the last example we used interfaces to define the types for the request querystring and headers. Many users will already be using JSON Schemas to define these properties, and luckily there is a way to transform existing JSON Schemas into TypeScript interfaces!</p><ol><li><p>If you did not complete the &#39;Getting Started&#39; example, go back and follow steps 1-4 first.</p></li><li><p>Install the <code>json-schema-to-typescript</code> module:</p><pre><code class=language-bash>npm i -D json-schema-to-typescript
</code></pre></li><li><p>Create a new folder called <code>schemas</code> and add two files <code>headers.json</code> and <code>querystring.json</code>. Copy and paste the following schema definitions into the respective files:</p><pre><code class=language-json>{
  &quot;title&quot;: &quot;Headers Schema&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;properties&quot;: {
    &quot;h-Custom&quot;: { &quot;type&quot;: &quot;string&quot; }
  },
  &quot;additionalProperties&quot;: false,
  &quot;required&quot;: [&quot;h-Custom&quot;]
}
</code></pre><pre><code class=language-json>{
  &quot;title&quot;: &quot;Querystring Schema&quot;,
  &quot;type&quot;: &quot;object&quot;,
  &quot;properties&quot;: {
    &quot;username&quot;: { &quot;type&quot;: &quot;string&quot; },
    &quot;password&quot;: { &quot;type&quot;: &quot;string&quot; }
  },
  &quot;additionalProperties&quot;: false,
  &quot;required&quot;: [&quot;username&quot;, &quot;password&quot;]
}
</code></pre></li><li><p>Add a <code>compile-schemas</code> script to the package.json:</p></li></ol><pre><code class=language-json>   {
     &quot;scripts&quot;: {
       &quot;compile-schemas&quot;: &quot;json2ts -i schemas -o types&quot;
     }
   }
</code></pre><p><code>json2ts</code> is a CLI utility included in <code>json-schema-to-typescript</code>. <code>schemas</code> is the input path, and <code>types</code> is the output path. 5. Run <code>npm run compile-schemas</code>. Two new files should have been created in the <code>types</code> directory. 6. Update <code>index.ts</code> to have the following code:</p><pre><code class=language-typescript>   import fastify from &#39;fastify&#39;

   // import json schemas as normal
   import QuerystringSchema from &#39;./schemas/querystring.json&#39;
   import HeadersSchema from &#39;./schemas/headers.json&#39;

   // import the generated interfaces
   import { QuerystringSchema as QuerystringSchemaInterface } from &#39;./types/querystring&#39;
   import { HeadersSchema as HeadersSchemaInterface } from &#39;./types/headers&#39;

   const server = fastify()

   server.get&lt;{
     Querystring: QuerystringSchemaInterface,
     Headers: HeadersSchemaInterface
   }&gt;(&#39;/auth&#39;, {
     schema: {
       querystring: QuerystringSchema,
       headers: HeadersSchema
     },
     preValidation: (request, reply, done) =&gt; {
       const { username, password } = request.query
       done(username !== &#39;admin&#39; ? new Error(&#39;Must be admin&#39;) : undefined)
     }
     //  or if using async
     //  preValidation: async (request, reply) =&gt; {
     //    const { username, password } = request.query
     //    if (username !== &quot;admin&quot;) throw new Error(&quot;Must be admin&quot;);
     //  }
   }, async (request, reply) =&gt; {
     const customerHeader = request.headers[&#39;h-Custom&#39;]
     // do something with request data
     return `logged in!`
   })

   server.route&lt;{
     Querystring: QuerystringSchemaInterface,
     Headers: HeadersSchemaInterface
   }&gt;({
     method: &#39;GET&#39;,
     url: &#39;/auth2&#39;,
     schema: {
       querystring: QuerystringSchema,
       headers: HeadersSchema
     },
     preHandler: (request, reply, done) =&gt; {
       const { username, password } = request.query
       const customerHeader = request.headers[&#39;h-Custom&#39;]
       done()
     },
     handler: (request, reply) =&gt; {
       const { username, password } = request.query
       const customerHeader = request.headers[&#39;h-Custom&#39;]
       reply.status(200).send({username});
     }
   })

   server.listen({ port: 8080 }, (err, address) =&gt; {
     if (err) {
       console.error(err)
       process.exit(0)
     }
     console.log(`Server listening at ${address}`)
   })
</code></pre><p>Pay special attention to the imports at the top of this file. It might seem redundant, but you need to import both the schema files and the generated interfaces.</p><p>Great work! Now you can make use of both JSON Schemas and TypeScript definitions.</p><h4 id=json-schema-to-ts>json-schema-to-ts</h4><p>If you do not want to generate types from your schemas, but want to use them directly from your code, you can use the package <a href=https://www.npmjs.com/package/json-schema-to-ts>json-schema-to-ts</a>.</p><p>You can install it as dev-dependency.</p><pre><code class=language-bash>npm i -D json-schema-to-ts
</code></pre><p>In your code you can define your schema like a normal object. But be aware of making it <em>const</em> like explained in the docs of the module.</p><pre><code class=language-typescript>const todo = {
  type: &#39;object&#39;,
  properties: {
    name: { type: &#39;string&#39; },
    description: { type: &#39;string&#39; },
    done: { type: &#39;boolean&#39; },
  },
  required: [&#39;name&#39;],
} as const; // don&#39;t forget to use const !
</code></pre><p>With the provided type <code>FromSchema</code> you can build a type from your schema and use it in your handler.</p><pre><code class=language-typescript>import { FromSchema } from &quot;json-schema-to-ts&quot;;
fastify.post&lt;{ Body: FromSchema&lt;typeof todo&gt; }&gt;(
  &#39;/todo&#39;,
  {
    schema: {
      body: todo,
      response: {
        201: {
          type: &#39;string&#39;,
        },
      },
    }
  },
  async (request, reply): Promise&lt;void&gt; =&gt; {

    /*
    request.body has type
    {
      [x: string]: unknown;
      description?: string;
      done?: boolean;
      name: string;
    }
    */

    request.body.name // will not throw type error
    request.body.notthere // will throw type error

    reply.status(201).send();
  },
);
</code></pre><h3 id=plugins>Plugins</h3><p>One of Fastify&#39;s most distinguishable features is its extensive plugin ecosystem. Plugin types are fully supported, and take advantage of the <a href=https://www.typescriptlang.org/docs/handbook/declaration-merging.html>declaration merging</a> pattern. This example is broken up into three parts: Creating a TypeScript Fastify Plugin, Creating Type Definitions for a Fastify Plugin, and Using a Fastify Plugin in a TypeScript Project.</p><h4 id=creating-a-typescript-fastify-plugin>Creating a TypeScript Fastify Plugin</h4><ol><li>Initialize a new npm project and install required dependencies<pre><code class=language-bash>npm init -y
npm i fastify fastify-plugin
npm i -D typescript @types/node
</code></pre></li><li>Add a <code>build</code> script to the <code>&quot;scripts&quot;</code> section and <code>&#39;index.d.ts&#39;</code> to the <code>&quot;types&quot;</code> section of the <code>package.json</code> file:<pre><code class=language-json>{
  &quot;types&quot;: &quot;index.d.ts&quot;,
  &quot;scripts&quot;: {
    &quot;build&quot;: &quot;tsc -p tsconfig.json&quot;
  }
}
</code></pre></li><li>Initialize a TypeScript configuration file:<pre><code class=language-bash>npx typescript --init
</code></pre>Once the file is generated, enable the <code>&quot;declaration&quot;</code> option in the <code>&quot;compilerOptions&quot;</code> object.<pre><code class=language-json>{
  &quot;compileOptions&quot;: {
    &quot;declaration&quot;: true
  }
}
</code></pre></li><li>Create an <code>index.ts</code> file - this will contain the plugin code</li><li>Add the following code to <code>index.ts</code><pre><code class=language-typescript>import { FastifyPluginCallback, FastifyPluginAsync } from &#39;fastify&#39;
import fp from &#39;fastify-plugin&#39;

// using declaration merging, add your plugin props to the appropriate fastify interfaces
// if prop type is defined here, the value will be typechecked when you call decorate{,Request,Reply}
declare module &#39;fastify&#39; {
  interface FastifyRequest {
    myPluginProp: string
  }
  interface FastifyReply {
    myPluginProp: number
  }
}

// define options
export interface MyPluginOptions {
  myPluginOption: string
}

// define plugin using callbacks
const myPluginCallback: FastifyPluginCallback&lt;MyPluginOptions&gt; = (fastify, options, done) =&gt; {
  fastify.decorateRequest(&#39;myPluginProp&#39;, &#39;super_secret_value&#39;)
  fastify.decorateReply(&#39;myPluginProp&#39;, options.myPluginOption)

  done()
}

// define plugin using promises
const myPluginAsync: FastifyPluginAsync&lt;MyPluginOptions&gt; = async (fastify, options) =&gt; {
  fastify.decorateRequest(&#39;myPluginProp&#39;, &#39;super_secret_value&#39;)
  fastify.decorateReply(&#39;myPluginProp&#39;, options.myPluginOption)
}

// export plugin using fastify-plugin
export default fp(myPluginCallback, &#39;3.x&#39;)
// or
// export default fp(myPluginAsync, &#39;3.x&#39;)
</code></pre></li><li>Run <code>npm run build</code> to compile the plugin code and produce both a JavaScript source file and a type definition file.</li><li>With the plugin now complete you can [publish to npm] or use it locally.<blockquote><p>You do not <em>need</em> to publish your plugin to npm to use it. You can include it in a Fastify project and reference it as you would any piece of code! As a TypeScript user, make sure the declaration override exists somewhere that will be included in your project compilation so the TypeScript interpreter can process it.</p></blockquote></li></ol><h4 id=creating-type-definitions-for-a-fastify-plugin>Creating Type Definitions for a Fastify Plugin</h4><p>This plugin guide is for Fastify plugins written in JavaScript. The steps outlined in this example are for adding TypeScript support for users consuming your plugin.</p><ol><li>Initialize a new npm project and install required dependencies<pre><code class=language-bash>npm init -y
npm i fastify-plugin
</code></pre></li><li>Create two files <code>index.js</code> and <code>index.d.ts</code></li><li>Modify the package json to include these files under the <code>main</code> and <code>types</code> properties (the name does not have to be <code>index</code> explicitly, but it is recommended the files have the same name):<pre><code class=language-json>{
  &quot;main&quot;: &quot;index.js&quot;,
  &quot;types&quot;: &quot;index.d.ts&quot;
}
</code></pre></li><li>Open <code>index.js</code> and add the following code:<pre><code class=language-javascript>// fastify-plugin is highly recommended for any plugin you write
const fp = require(&#39;fastify-plugin&#39;)

function myPlugin (instance, options, done) {

  // decorate the fastify instance with a custom function called myPluginFunc
  instance.decorate(&#39;myPluginFunc&#39;, (input) =&gt; {
    return input.toUpperCase()
  })

  done()
}

module.exports = fp(myPlugin, {
  fastify: &#39;3.x&#39;,
  name: &#39;my-plugin&#39; // this is used by fastify-plugin to derive the property name
})
</code></pre></li><li>Open <code>index.d.ts</code> and add the following code:<pre><code class=language-typescript>import { FastifyPlugin } from &#39;fastify&#39;

interface PluginOptions {
  //...
}

// Optionally, you can add any additional exports.
// Here we are exporting the decorator we added.
export interface myPluginFunc {
  (input: string): string
}

// Most importantly, use declaration merging to add the custom property to the Fastify type system
declare module &#39;fastify&#39; {
  interface FastifyInstance {
    myPluginFunc: myPluginFunc
  }
}

// fastify-plugin automatically adds named export, so be sure to add also this type
// the variable name is derived from `options.name` property if `module.exports.myPlugin` is missing
export const myPlugin: FastifyPlugin&lt;PluginOptions&gt;

// fastify-plugin automatically adds `.default` property to the exported plugin. See the note below
export default myPlugin
</code></pre></li></ol><p><strong>Note</strong>: <a href=https://github.com/fastify/fastify-plugin>fastify-plugin</a> v2.3.0 and newer, automatically adds <code>.default</code> property and a named export to the exported plugin. Be sure to <code>export default</code> and <code>export const myPlugin</code> in your typings to provide the best developer experience. For a complete example you can check out <a href=https://github.com/fastify/fastify-swagger/blob/master/index.d.ts>@fastify/swagger</a>.</p><p>With those files completed, the plugin is now ready to be consumed by any TypeScript project!</p><p>The Fastify plugin system enables developers to decorate the Fastify instance, and the request/reply instances. For more information check out this blog post on <a href=https://dev.to/ethanarrowood/is-declaration-merging-and-generic-inheritance-at-the-same-time-impossible-53cp>Declaration Merging and Generic Inheritance</a>.</p><h4 id=using-a-plugin>Using a Plugin</h4><p>Using a Fastify plugin in TypeScript is just as easy as using one in JavaScript. Import the plugin with <code>import/from</code> and you&#39;re all set -- except there is one exception users should be aware of.</p><p>Fastify plugins use declaration merging to modify existing Fastify type interfaces (check out the previous two examples for more details). Declaration merging is not very <em>smart</em>, meaning if the plugin type definition for a plugin is within the scope of the TypeScript interpreter, then the plugin types will be included <strong>regardless</strong> of if the plugin is being used or not. This is an unfortunate limitation of using TypeScript and is unavoidable as of right now.</p><p>However, there are a couple of suggestions to help improve this experience:</p><ul><li>Make sure the <code>no-unused-vars</code> rule is enabled in <a href=https://eslint.org/docs/rules/no-unused-vars>ESLint</a> and any imported plugin are actually being loaded.</li><li>Use a module such as <a href=https://www.npmjs.com/package/depcheck>depcheck</a> or <a href=https://www.npmjs.com/package/npm-check>npm-check</a> to verify plugin dependencies are being used somewhere in your project.</li></ul><p>Note that using <code>require</code> will not load the type definitions properly and may cause type errors. TypeScript can only identify the types that are directly imported into code, which means that you can use require inline with import on top. For example:</p><pre><code class=language-typescript>import &#39;plugin&#39; // here will trigger the type augmentation.

fastify.register(require(&#39;plugin&#39;))
</code></pre><pre><code class=language-typescript>import plugin from &#39;plugin&#39; //  here will trigger the type augmentation.

fastify.register(plugin)
</code></pre><p>Or even explicit config on tsconfig</p><pre><code class=language-jsonc>{
  &quot;types&quot;: [&quot;plugin&quot;] // we force TypeScript to import the types
}
</code></pre><h2 id=code-completion-in-vanilla-javascript>Code Completion In Vanilla JavaScript</h2><p>Vanilla JavaScript can use the published types to provide code completion (e.g. <a href=https://code.visualstudio.com/docs/editor/intellisense>Intellisense</a>) by following the <a href=https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html>TypeScript JSDoc Reference</a>.</p><p>For example:</p><pre><code class=language-js>/**  @type {import(&#39;fastify&#39;).FastifyPluginAsync&lt;{ optionA: boolean, optionB: string }&gt;} */
module.exports = async function (fastify, { optionA, optionB }) {
  fastify.get(&#39;/look&#39;, () =&gt; &#39;at me&#39;);
}
</code></pre><h2 id=api-type-system-documentation>API Type System Documentation</h2><p>This section is a detailed account of all the types available to you in Fastify version 3.x</p><p>All <code>http</code>, <code>https</code>, and <code>http2</code> types are inferred from <code>@types/node</code></p><p><a href=#generics>Generics</a> are documented by their default value as well as their constraint value(s). Read these articles for more information on TypeScript generics.</p><ul><li><a href=https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-3.html#generic-parameter-defaults>Generic Parameter Default</a></li><li><a href=https://www.typescriptlang.org/docs/handbook/generics.html#generic-constraints>Generic Constraints</a></li></ul><h4 id=how-to-import>How to import</h4><p>The Fastify API is powered by the <code>fastify()</code> method. In JavaScript you would import it using <code>const fastify = require(&#39;fastify&#39;)</code>. In TypeScript it is recommended to use the <code>import/from</code> syntax instead so types can be resolved. There are a couple supported import methods with the Fastify type system.</p><ol><li><code>import fastify from &#39;fastify&#39;</code><ul><li>Types are resolved but not accessible using dot notation</li><li>Example:<pre><code class=language-typescript>import fastify from &#39;fastify&#39;

const f = fastify()
f.listen({ port: 8080 }, () =&gt; { console.log(&#39;running&#39;) })
</code></pre></li><li>Gain access to types with destructuring:<pre><code class=language-typescript>import fastify, { FastifyInstance } from &#39;fastify&#39;

const f: FastifyInstance = fastify()
f.listen({ port: 8080 }, () =&gt; { console.log(&#39;running&#39;) })
</code></pre></li><li>Destructuring also works for the main API method:<pre><code class=language-typescript>import { fastify, FastifyInstance } from &#39;fastify&#39;

const f: FastifyInstance = fastify()
f.listen({ port: 8080 }, () =&gt; { console.log(&#39;running&#39;) })
</code></pre></li></ul></li><li><code>import * as Fastify from &#39;fastify&#39;</code><ul><li>Types are resolved and accessible using dot notation</li><li>Calling the main Fastify API method requires a slightly different syntax (see example)</li><li>Example:<pre><code class=language-typescript>import * as Fastify from &#39;fastify&#39;

const f: Fastify.FastifyInstance = Fastify.fastify()
f.listen({ port: 8080 }, () =&gt; { console.log(&#39;running&#39;) })
</code></pre></li></ul></li><li><code>const fastify = require(&#39;fastify&#39;)</code><ul><li>This syntax is valid and will import fastify as expected; however, types will <strong>not</strong> be resolved</li><li>Example:<pre><code class=language-typescript>const fastify = require(&#39;fastify&#39;)

const f = fastify()
f.listen({ port: 8080 }, () =&gt; { console.log(&#39;running&#39;) })
</code></pre></li><li>Destructuring is supported and will resolve types properly<pre><code class=language-typescript>const { fastify } = require(&#39;fastify&#39;)

const f = fastify()
f.listen({ port: 8080 }, () =&gt; { console.log(&#39;running&#39;) })
</code></pre></li></ul></li></ol><h4 id=generics>Generics</h4><p>Many type definitions share the same generic parameters; they are all documented, in detail, within this section.</p><p>Most definitions depend on <code>@node/types</code> modules <code>http</code>, <code>https</code>, and <code>http2</code></p><h5 id=rawserver>RawServer</h5><p>Underlying Node.js server type</p><p>Default: <code>http.Server</code></p><p>Constraints: <code>http.Server</code>, <code>https.Server</code>, <code>http2.Http2Server</code>, <code>http2.Http2SecureServer</code></p><p>Enforces generic parameters: <a href=#rawrequest><code>RawRequest</code></a>, <a href=#rawreply><code>RawReply</code></a></p><h5 id=rawrequest>RawRequest</h5><p>Underlying Node.js request type</p><p>Default: <a href=#fastifyrawrequestdefaultexpressionrawserver><code>RawRequestDefaultExpression</code></a></p><p>Constraints: <code>http.IncomingMessage</code>, <code>http2.Http2ServerRequest</code></p><p>Enforced by: <a href=#rawserver><code>RawServer</code></a></p><h5 id=rawreply>RawReply</h5><p>Underlying Node.js response type</p><p>Default: <a href=#fastifyrawreplydefaultexpression><code>RawReplyDefaultExpression</code></a></p><p>Constraints: <code>http.ServerResponse</code>, <code>http2.Http2ServerResponse</code></p><p>Enforced by: <a href=#rawserver><code>RawServer</code></a></p><h5 id=logger>Logger</h5><p>Fastify logging utility</p><p>Default: <a href=#fastifyfastifyloggeroptions><code>FastifyLoggerOptions</code></a></p><p>Enforced by: <a href=#rawserver><code>RawServer</code></a></p><h5 id=rawbody>RawBody</h5><p>A generic parameter for the content-type-parser methods.</p><p>Constraints: <code>string | Buffer</code></p><hr><h4 id=fastify>Fastify</h4><h5 id=fastifyrawserver-rawrequest-rawreply-loggeropts-fastifyserveroptions-fastifyinstance>fastify&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>, <a href=#logger>Logger</a>&gt;(opts?: <a href=#fastifyfastifyserveroptions-rawserver-logger>FastifyServerOptions</a>): <a href=#fastifyfastifyinstance>FastifyInstance</a></h5><p><a href=https://github.com/fastify/fastify/blob/main/fastify.d.ts#L19>src</a></p><p>The main Fastify API method. By default creates an HTTP server. Utilizing discriminant unions and overload methods, the type system will automatically infer which type of server (http, https, or http2) is being created purely based on the options based to the method (see the examples below for more information). It also supports an extensive generic type system to allow the user to extend the underlying Node.js Server, Request, and Reply objects. Additionally, the <code>Logger</code> generic exists for custom log types. See the examples and generic breakdown below for more information.</p><h6 id=example-1-standard-http-server>Example 1: Standard HTTP server</h6><p>No need to specify the <code>Server</code> generic as the type system defaults to HTTP.</p><pre><code class=language-typescript>import fastify from &#39;fastify&#39;

const server = fastify()
</code></pre><p>Check out the Learn By Example - <a href=#getting-started>Getting Started</a> example for a more detailed http server walkthrough.</p><h6 id=example-2-https-sever>Example 2: HTTPS sever</h6><ol><li>Create the following imports from <code>@types/node</code> and <code>fastify</code><pre><code class=language-typescript>import fs from &#39;fs&#39;
import path from &#39;path&#39;
import fastify from &#39;fastify&#39;
</code></pre></li><li>Follow the steps in this official <a href=https://nodejs.org/en/knowledge/HTTP/servers/how-to-create-a-HTTPS-server/ >Node.js https server guide</a> to create the <code>key.pem</code> and <code>cert.pem</code> files</li><li>Instantiate a Fastify https server and add a route:<pre><code class=language-typescript>const server = fastify({
  https: {
    key: fs.readFileSync(path.join(__dirname, &#39;key.pem&#39;)),
    cert: fs.readFileSync(path.join(__dirname, &#39;cert.pem&#39;))
  }
})

server.get(&#39;/&#39;, async function (request, reply) {
  return { hello: &#39;world&#39; }
})

server.listen({ port: 8080 }, (err, address) =&gt; {
  if (err) {
    console.error(err)
    process.exit(0)
  }
  console.log(`Server listening at ${address}`)
})
</code></pre></li><li>Build and run! Test your server out by querying with: <code>curl -k https://localhost:8080</code></li></ol><h6 id=example-3-http2-server>Example 3: HTTP2 server</h6><p>There are two types of HTTP2 server types, insecure and secure. Both require specifying the <code>http2</code> property as <code>true</code> in the <code>options</code> object. The <code>https</code> property is used for creating a secure http2 server; omitting the <code>https</code> property will create an insecure http2 server.</p><pre><code class=language-typescript>const insecureServer = fastify({ http2: true })
const secureServer = fastify({
  http2: true,
  https: {} // use the `key.pem` and `cert.pem` files from the https section
})
</code></pre><p>For more details on using HTTP2 check out the Fastify <a href=.././HTTP2>HTTP2</a> documentation page.</p><h6 id=example-4-extended-http-server>Example 4: Extended HTTP server</h6><p>Not only can you specify the server type, but also the request and reply types. Thus, allowing you to specify special properties, methods, and more! When specified at server instantiation, the custom type becomes available on all further instances of the custom type.</p><pre><code class=language-typescript>import fastify from &#39;fastify&#39;
import http from &#39;http&#39;

interface customRequest extends http.IncomingMessage {
  mySpecialProp: string
}

const server = fastify&lt;http.Server, customRequest&gt;()

server.get(&#39;/&#39;, async (request, reply) =&gt; {
  const someValue = request.raw.mySpecialProp // TS knows this is a string, because of the `customRequest` interface
  return someValue.toUpperCase()
})
</code></pre><h6 id=example-5-specifying-logger-types>Example 5: Specifying logger types</h6><p>Fastify uses <a href=https://getpino.io/#/ >Pino</a> logging library under the hood. Since <code>pino@7</code>, all of it&#39;s properties can be configured via <code>logger</code> field when constructing Fastify&#39;s instance. If properties you need aren&#39;t exposed, please open an Issue to <a href=https://github.com/pinojs/pino/issues><code>Pino</code></a> or pass a preconfigured external instance of Pino (or any other compatible logger) as temporary fix to Fastify via the same field. This allows creating custom serializers as well, see the <a href=Logging.md>Logging</a> documentation for more info.</p><pre><code class=language-typescript>import fastify from &#39;fastify&#39;

const server = fastify({
  logger: {
    level: &#39;info&#39;,
    redact: [&#39;x-userinfo&#39;],
    messageKey: &#39;message&#39;
  }
})

server.get(&#39;/&#39;, async (request, reply) =&gt; {
  server.log.info(&#39;log message&#39;)
  return &#39;another message&#39;
})
</code></pre><hr><h5 id=fastifyhttpmethods>fastify.HTTPMethods</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/utils.d.ts#L8>src</a></p><p>Union type of: <code>&#39;DELETE&#39; | &#39;GET&#39; | &#39;HEAD&#39; | &#39;PATCH&#39; | &#39;POST&#39; | &#39;PUT&#39; | &#39;OPTIONS&#39;</code></p><h5 id=fastifyrawserverbase>fastify.RawServerBase</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/utils.d.ts#L13>src</a></p><p>Dependant on <code>@types/node</code> modules <code>http</code>, <code>https</code>, <code>http2</code></p><p>Union type of: <code>http.Server | https.Server | http2.Http2Server | http2.Http2SecureServer</code></p><h5 id=fastifyrawserverdefault>fastify.RawServerDefault</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/utils.d.ts#L18>src</a></p><p>Dependant on <code>@types/node</code> modules <code>http</code></p><p>Type alias for <code>http.Server</code></p><hr><h5 id=fastifyfastifyserveroptionsrawserver-logger>fastify.FastifyServerOptions&lt;<a href=#rawserver>RawServer</a>, <a href=#logger>Logger</a>&gt;</h5><p><a href=https://github.com/fastify/fastify/blob/main/fastify.d.ts#L29>src</a></p><p>An interface of properties used in the instantiation of the Fastify server. Is used in the main <a href=#fastifyrawserver-rawrequest-rawreply-loggeropts-fastifyserveroptions-fastifyinstance><code>fastify()</code></a> method. The <code>RawServer</code> and <code>Logger</code> generic parameters are passed down through that method.</p><p>See the main <a href=#fastifyrawserver-rawrequest-rawreply-loggeropts-fastifyserveroptions-fastifyinstance>fastify</a> method type definition section for examples on instantiating a Fastify server with TypeScript.</p><h5 id=fastifyfastifyinstancerawserver-rawrequest-requestgeneric-logger>fastify.FastifyInstance&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#fastifyrequestgenericinterface>RequestGeneric</a>, <a href=#logger>Logger</a>&gt;</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/instance.d.ts#L16>src</a></p><p>Interface that represents the Fastify server object. This is the returned server instance from the <a href=#fastifyrawserver-rawrequest-rawreply-loggeropts-fastifyserveroptions-fastifyinstance><code>fastify()</code></a> method. This type is an interface so it can be extended via <a href=https://www.typescriptlang.org/docs/handbook/declaration-merging.html>declaration merging</a> if your code makes use of the <code>decorate</code> method.</p><p>Through the use of generic cascading, all methods attached to the instance inherit the generic properties from instantiation. This means that by specifying the server, request, or reply types, all methods will know how to type those objects.</p><p>Check out the main <a href=#learn-by-example>Learn by Example</a> section for detailed guides, or the more simplified <a href=#fastifyrawserver-rawrequest-rawreply-loggeropts-fastifyserveroptions-fastifyinstance>fastify</a> method examples for additional details on this interface.</p><hr><h4 id=request>Request</h4><h5 id=fastifyfastifyrequestrequestgeneric-rawserver-rawrequest>fastify.FastifyRequest&lt;<a href=#fastifyrequestgenericinterface>RequestGeneric</a>, <a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>&gt;</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/request.d.ts#L15>src</a></p><p>This interface contains properties of Fastify request object. The properties added here disregard what kind of request object (http vs http2) and disregard what route level it is serving; thus calling <code>request.body</code> inside a GET request will not throw an error (but good luck sending a GET request with a body 😉).</p><p>If you need to add custom properties to the <code>FastifyRequest</code> object (such as when using the [<code>decorateRequest</code>][DecorateRequest] method) you need to use declaration merging on this interface.</p><p>A basic example is provided in the <a href=#fastifyfastifyrequestrawserver-rawrequest-requestgeneric><code>FastifyRequest</code></a> section. For a more detailed example check out the Learn By Example section: <a href=#plugins>Plugins</a></p><h6 id=example>Example</h6><pre><code class=language-typescript>import fastify from &#39;fastify&#39;

const server = fastify()

server.decorateRequest(&#39;someProp&#39;, &#39;hello!&#39;)

server.get(&#39;/&#39;, async (request, reply) =&gt; {
  const { someProp } = request // need to use declaration merging to add this prop to the request interface
  return someProp
})

// this declaration must be in scope of the typescript interpreter to work
declare module &#39;fastify&#39; {
  interface FastifyRequest { // you must reference the interface and not the type
    someProp: string
  }
}

// Or you can type your request using
type CustomRequest = FastifyRequest&lt;{
  Body: { test: boolean };
}&gt;

server.get(&#39;/typedRequest&#39;, async (request: CustomRequest, reply: FastifyReply) =&gt; {
  return request.body.test
})
</code></pre><h5 id=fastifyrequestgenericinterface>fastify.RequestGenericInterface</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/request.d.ts#L4>src</a></p><p>Fastify request objects have four dynamic properties: <code>body</code>, <code>params</code>, <code>query</code>, and <code>headers</code>. Their respective types are assignable through this interface. It is a named property interface enabling the developer to ignore the properties they do not want to specify. All omitted properties are defaulted to <code>unknown</code>. The corresponding property names are: <code>Body</code>, <code>Querystring</code>, <code>Params</code>, <code>Headers</code>.</p><pre><code class=language-typescript>import fastify, { RequestGenericInterface } from &#39;fastify&#39;

const server = fastify()

interface requestGeneric extends RequestGenericInterface {
  Querystring: {
    name: string
  }
}

server.get&lt;requestGeneric&gt;(&#39;/&#39;, async (request, reply) =&gt; {
  const { name } = request.query // the name prop now exists on the query prop
  return name.toUpperCase()
})
</code></pre><p>If you want to see a detailed example of using this interface check out the Learn by Example section: <a href=#jsonschema>JSON Schema</a>.</p><h5 id=fastifyrawrequestdefaultexpressionrawserver>fastify.RawRequestDefaultExpression&lt;<a href=#rawserver>RawServer</a>&gt;</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/utils.d.ts#L23>src</a></p><p>Dependant on <code>@types/node</code> modules <code>http</code>, <code>https</code>, <code>http2</code></p><p>Generic parameter <code>RawServer</code> defaults to <a href=#fastifyrawserverdefault><code>RawServerDefault</code></a></p><p>If <code>RawServer</code> is of type <code>http.Server</code> or <code>https.Server</code>, then this expression returns <code>http.IncomingMessage</code>, otherwise, it returns <code>http2.Http2ServerRequest</code>.</p><pre><code class=language-typescript>import http from &#39;http&#39;
import http2 from &#39;http2&#39;
import { RawRequestDefaultExpression } from &#39;fastify&#39;

RawRequestDefaultExpression&lt;http.Server&gt; // -&gt; http.IncomingMessage
RawRequestDefaultExpression&lt;http2.Http2Server&gt; // -&gt; http2.Http2ServerRequest
</code></pre><hr><h4 id=reply>Reply</h4><h5 id=fastifyfastifyreplyrawserver-rawrequest-rawreply-requestgeneric-contextconfig>fastify.FastifyReply&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>, <a href=#fastifyrequestgenericinterface>RequestGeneric</a>, <a href=#ContextConfigGeneric>ContextConfig</a>&gt;</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/reply.d.ts#L32>src</a></p><p>This interface contains the custom properties that Fastify adds to the standard Node.js reply object. The properties added here disregard what kind of reply object (http vs http2).</p><p>If you need to add custom properties to the FastifyReply object (such as when using the <code>decorateReply</code> method) you need to use declaration merging on this interface.</p><p>A basic example is provided in the <a href=#fastifyfastifyreplyrawserver-rawreply-contextconfig><code>FastifyReply</code></a> section. For a more detailed example check out the Learn By Example section: <a href=#plugins>Plugins</a></p><h6 id=example-1>Example</h6><pre><code class=language-typescript>import fastify from &#39;fastify&#39;

const server = fastify()

server.decorateReply(&#39;someProp&#39;, &#39;world&#39;)

server.get(&#39;/&#39;, async (request, reply) =&gt; {
  const { someProp } = reply // need to use declaration merging to add this prop to the reply interface
  return someProp
})

// this declaration must be in scope of the typescript interpreter to work
declare module &#39;fastify&#39; {
  interface FastifyReply { // you must reference the interface and not the type
    someProp: string
  }
}
</code></pre><h5 id=fastifyrawreplydefaultexpressionrawserver>fastify.RawReplyDefaultExpression&lt;<a href=#rawserver>RawServer</a>&gt;</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/utils.d.ts#L27>src</a></p><p>Dependant on <code>@types/node</code> modules <code>http</code>, <code>https</code>, <code>http2</code></p><p>Generic parameter <code>RawServer</code> defaults to <a href=#fastifyrawserverdefault><code>RawServerDefault</code></a></p><p>If <code>RawServer</code> is of type <code>http.Server</code> or <code>https.Server</code>, then this expression returns <code>http.ServerResponse</code>, otherwise, it returns <code>http2.Http2ServerResponse</code>.</p><pre><code class=language-typescript>import http from &#39;http&#39;
import http2 from &#39;http2&#39;
import { RawReplyDefaultExpression } from &#39;fastify&#39;

RawReplyDefaultExpression&lt;http.Server&gt; // -&gt; http.ServerResponse
RawReplyDefaultExpression&lt;http2.Http2Server&gt; // -&gt; http2.Http2ServerResponse
</code></pre><hr><h4 id=plugin>Plugin</h4><p>Fastify allows the user to extend its functionalities with plugins. A plugin can be a set of routes, a server decorator or whatever. To activate plugins, use the <a href=#fastifyfastifyregisterrawserver-rawrequest-requestgenericplugin-fastifyplugin-opts-fastifyregisteroptions><code>fastify.register()</code></a> method.</p><p>When creating plugins for Fastify, it is recommended to use the <code>fastify-plugin</code> module. Additionally, there is a guide to creating plugins with TypeScript and Fastify available in the Learn by Example, <a href=#plugins>Plugins</a> section.</p><h5 id=fastifyfastifyplugincallbackoptions>fastify.FastifyPluginCallback&lt;<a href=#fastifyfastifypluginoptions>Options</a>&gt;</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/plugin.d.ts#L9>src</a></p><p>Interface method definition used within the <a href=#fastifyfastifyregisterrawserver-rawrequest-requestgenericplugin-fastifyplugin-opts-fastifyregisteroptions><code>fastify.register()</code></a> method.</p><h5 id=fastifyfastifypluginasyncoptions>fastify.FastifyPluginAsync&lt;<a href=#fastifyfastifypluginoptions>Options</a>&gt;</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/plugin.d.ts#L20>src</a></p><p>Interface method definition used within the <a href=#fastifyfastifyregisterrawserver-rawrequest-requestgenericplugin-fastifyplugin-opts-fastifyregisteroptions><code>fastify.register()</code></a> method.</p><h5 id=fastifyfastifypluginoptions>fastify.FastifyPlugin&lt;<a href=#fastifyfastifypluginoptions>Options</a>&gt;</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/plugin.d.ts#L29>src</a></p><p>Interface method definition used within the <a href=#fastifyfastifyregisterrawserver-rawrequest-requestgenericplugin-fastifyplugin-opts-fastifyregisteroptions><code>fastify.register()</code></a> method. Document deprecated in favor of <code>FastifyPluginCallback</code> and <code>FastifyPluginAsync</code> since general <code>FastifyPlugin</code> doesn&#39;t properly infer types for async functions.</p><h5 id=fastifyfastifypluginoptions-1>fastify.FastifyPluginOptions</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/plugin.d.ts#L31>src</a></p><p>A loosely typed object used to constrain the <code>options</code> parameter of <a href=#fastifyfastifyregisterrawserver-rawrequest-requestgenericplugin-fastifyplugin-opts-fastifyregisteroptions><code>fastify.register()</code></a> to an object. When creating a plugin, define its options as an extension of this interface (<code>interface MyPluginOptions extends FastifyPluginOptions</code>) so they can be passed to the register method.</p><hr><h4 id=register>Register</h4><h5 id=fastifyfastifyregisterplugin-fastifyplugincallback-opts-fastifyregisteroptions>fastify.FastifyRegister(plugin: <a href=#fastifyfastifyplugincallbackoptions>FastifyPluginCallback</a>, opts: <a href=#fastifyfastifytregisteroptions>FastifyRegisterOptions</a>)</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/register.d.ts#L9>src</a></p><h5 id=fastifyfastifyregisterplugin-fastifypluginasync-opts-fastifyregisteroptions>fastify.FastifyRegister(plugin: <a href=#fastifyfastifypluginasyncoptions>FastifyPluginAsync</a>, opts: <a href=#fastifyfastifytregisteroptions>FastifyRegisterOptions</a>)</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/register.d.ts#L9>src</a></p><h5 id=fastifyfastifyregisterplugin-fastifyplugin-opts-fastifyregisteroptions>fastify.FastifyRegister(plugin: <a href=#fastifyfastifypluginoptions-rawserver-rawrequest-requestgeneric>FastifyPlugin</a>, opts: <a href=#fastifyfastifytregisteroptions>FastifyRegisterOptions</a>)</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/register.d.ts#L9>src</a></p><p>This type interface specifies the type for the <a href=.././Server#register><code>fastify.register()</code></a> method. The type interface returns a function signature with an underlying generic <code>Options</code> which is defaulted to <a href=#fastifyfastifypluginoptions>FastifyPluginOptions</a>. It infers this generic from the FastifyPlugin parameter when calling this function so there is no need to specify the underlying generic. The options parameter is the intersection of the plugin&#39;s options and two additional optional properties: <code>prefix: string</code> and <code>logLevel</code>: <a href=#fastifyloglevel>LogLevel</a>.</p><p>Below is an example of the options inference in action:</p><pre><code class=language-typescript>const server = fastify()

const plugin: FastifyPlugin&lt;{
  option1: string;
  option2: boolean;
}&gt; = function (instance, opts, done) { }

server().register(plugin, {}) // Error - options object is missing required properties
server().register(plugin, { option1: &#39;&#39;, option2: true }) // OK - options object contains required properties
</code></pre><p>See the Learn By Example, <a href=#plugins>Plugins</a> section for more detailed examples of creating TypeScript plugins in Fastify.</p><h5 id=fastifyfastifyregisteroptions>fastify.FastifyRegisterOptions</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/register.d.ts#L16>src</a></p><p>This type is the intersection of the <code>Options</code> generic and a non-exported interface <code>RegisterOptions</code> that specifies two optional properties: <code>prefix: string</code> and <code>logLevel</code>: <a href=#fastifyloglevel>LogLevel</a>. This type can also be specified as a function that returns the previously described intersection.</p><hr><h4 id=logger-1>Logger</h4><p>Check out the <a href=#example-5-specifying-logger-types>Specifying Logger Types</a> example for more details on specifying a custom logger.</p><h5 id=fastifyfastifyloggeroptionsrawserver-rawrequest-rawreply>fastify.FastifyLoggerOptions&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>&gt;</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/logger.d.ts#L17>src</a></p><p>An interface definition for the internal Fastify logger. It is emulative of the <a href=https://getpino.io/#/ >Pino.js</a> logger. When enabled through server options, use it following the general <a href=.././Logging>logger</a> documentation.</p><h5 id=fastifyfastifylogfn>fastify.FastifyLogFn</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/logger.d.ts#L7>src</a></p><p>An overload function interface that implements the two ways Fastify calls log methods. This interface is passed to all associated log level properties on the FastifyLoggerOptions object.</p><h5 id=fastifyloglevel>fastify.LogLevel</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/logger.d.ts#L12>src</a></p><p>Union type of: <code>&#39;info&#39; | &#39;error&#39; | &#39;debug&#39; | &#39;fatal&#39; | &#39;warn&#39; | &#39;trace&#39;</code></p><hr><h4 id=context>Context</h4><p>The context type definition is similar to the other highly dynamic pieces of the type system. Route context is available in the route handler method.</p><h5 id=fastifyfastifycontext>fastify.FastifyContext</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/context.d.ts#L6>src</a></p><p>An interface with a single required property <code>config</code> that is set by default to <code>unknown</code>. Can be specified either using a generic or an overload.</p><p>This type definition is potentially incomplete. If you are using it and can provide more details on how to improve the definition, we strongly encourage you to open an issue in the main <a href=https://github.com/fastify/fastify>fastify/fastify</a> repository. Thank you in advanced!</p><hr><h4 id=routing>Routing</h4><p>One of the core principles in Fastify is its routing capabilities. Most of the types defined in this section are used under-the-hood by the Fastify instance <code>.route</code> and <code>.get/.post/.etc</code> methods.</p><h5 id=fastifyroutehandlermethodrawserver-rawrequest-rawreply-requestgeneric-contextconfig>fastify.RouteHandlerMethod&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>, <a href=#fastifyrequestgenericinterface>RequestGeneric</a>, <a href=#ContextConfigGeneric>ContextConfig</a>&gt;</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/route.d.ts#L105>src</a></p><p>A type declaration for the route handler methods. Has two arguments, <code>request</code> and <code>reply</code> which are typed by <code>FastifyRequest</code> and <code>FastifyReply</code> respectfully. The generics parameters are passed through to these arguments. The method returns either <code>void</code> or <code>Promise&lt;any&gt;</code> for synchronous and asynchronous handlers respectfully.</p><h5 id=fastifyrouteoptionsrawserver-rawrequest-rawreply-requestgeneric-contextconfig>fastify.RouteOptions&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>, <a href=#fastifyrequestgenericinterface>RequestGeneric</a>, <a href=#ContextConfigGeneric>ContextConfig</a>&gt;</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/route.d.ts#L78>src</a></p><p>An interface that extends RouteShorthandOptions and adds the following three required properties:</p><ol><li><code>method</code> which corresponds to a singular <a href=#fastifyhttpmethods>HTTPMethod</a> or a list of <a href=#fastifyhttpmethods>HTTPMethods</a></li><li><code>url</code> a string for the route</li><li><code>handler</code> the route handler method, see [RouteHandlerMethod][] for more details</li></ol><h5 id=fastifyrouteshorthandmethodrawserver-rawrequest-rawreply>fastify.RouteShorthandMethod&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>&gt;</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/route.d.ts#12>src</a></p><p>An overloaded function interface for three kinds of shorthand route methods to be used in conjunction with the <code>.get/.post/.etc</code> methods.</p><h5 id=fastifyrouteshorthandoptionsrawserver-rawrequest-rawreply-requestgeneric-contextconfig>fastify.RouteShorthandOptions&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>, <a href=#fastifyrequestgenericinterface>RequestGeneric</a>, <a href=#ContextConfigGeneric>ContextConfig</a>&gt;</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/route.d.ts#55>src</a></p><p>An interface that covers all of the base options for a route. Each property on this interface is optional, and it serves as the base for the RouteOptions and RouteShorthandOptionsWithHandler interfaces.</p><h5 id=fastifyrouteshorthandoptionswithhandlerrawserver-rawrequest-rawreply-requestgeneric-contextconfig>fastify.RouteShorthandOptionsWithHandler&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>, <a href=#fastifyrequestgenericinterface>RequestGeneric</a>, <a href=#ContextConfigGeneric>ContextConfig</a>&gt;</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/route.d.ts#93>src</a></p><p>This interface adds a single, required property to the RouteShorthandOptions interface <code>handler</code> which is of type RouteHandlerMethod</p><hr><h4 id=parsers>Parsers</h4><h5 id=rawbody-1>RawBody</h5><p>A generic type that is either a <code>string</code> or <code>Buffer</code></p><h5 id=fastifyfastifybodyparserrawbody-rawserver-rawrequest>fastify.FastifyBodyParser&lt;<a href=#rawbody>RawBody</a>, <a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>&gt;</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/content-type-parser.d.ts#L7>src</a></p><p>A function type definition for specifying a body parser method. Use the <code>RawBody</code> generic to specify the type of the body being parsed.</p><h5 id=fastifyfastifycontenttypeparserrawserver-rawrequest>fastify.FastifyContentTypeParser&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>&gt;</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/content-type-parser.d.ts#L17>src</a></p><p>A function type definition for specifying a body parser method. Content is typed via the <code>RawRequest</code> generic.</p><h5 id=fastifyaddcontenttypeparserrawserver-rawrequest>fastify.AddContentTypeParser&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>&gt;</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/content-type-parser.d.ts#L46>src</a></p><p>An overloaded interface function definition for the <code>addContentTypeParser</code> method. If <code>parseAs</code> is passed to the <code>opts</code> parameter, the definition uses [FastifyBodyParser][] for the <code>parser</code> parameter; otherwise, it uses [FastifyContentTypeParser][].</p><h5 id=fastifyhascontenttypeparser>fastify.hasContentTypeParser</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/content-type-parser.d.ts#L63>src</a></p><p>A method for checking the existence of a type parser of a certain content type</p><hr><h4 id=errors>Errors</h4><h5 id=fastifyfastifyerror>fastify.FastifyError</h5><p><a href=https://github.com/fastify/fastify/blob/main/fastify.d.ts#L179>src</a></p><p>FastifyError is a custom error object that includes status code and validation results.</p><p>It extends the Node.js <code>Error</code> type, and adds two additional, optional properties: <code>statusCode: number</code> and <code>validation: ValidationResult[]</code>.</p><h5 id=fastifyvalidationresult>fastify.ValidationResult</h5><p><a href=https://github.com/fastify/fastify/blob/main/fastify.d.ts#L184>src</a></p><p>The route validation internally relies upon Ajv, which is a high-performance JSON schema validator.</p><p>This interface is passed to instance of FastifyError.</p><hr><h4 id=hooks>Hooks</h4><h5 id=fastifyonrequesthookhandlerrawserver-rawrequest-rawreply-requestgeneric-contextconfigrequest-fastifyrequest-reply-fastifyreply-done-err-fastifyerror--void-promiseunknown--void>fastify.onRequestHookHandler&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>, <a href=#fastifyrequestgenericinterface>RequestGeneric</a>, <a href=#ContextConfigGeneric>ContextConfig</a>&gt;(request: <a href=#fastifyfastifyrequestrawserver-rawrequest-requestgeneric>FastifyRequest</a>, reply: <a href=#fastifyfastifyreplyrawserver-rawreply-contextconfig>FastifyReply</a>, done: (err?: <a href=#fastifyfastifyerror>FastifyError</a>) =&gt; void): Promise&lt;unknown&gt; | void</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/hooks.d.ts#L17>src</a></p><p><code>onRequest</code> is the first hook to be executed in the request lifecycle. There was no previous hook, the next hook will be <code>preParsing</code>.</p><p>Notice: in the <code>onRequest</code> hook, request.body will always be null, because the body parsing happens before the <code>preHandler</code> hook.</p><h5 id=fastifypreparsinghookhandlerrawserver-rawrequest-rawreply-requestgeneric-contextconfigrequest-fastifyrequest-reply-fastifyreply-done-err-fastifyerror--void-promiseunknown--void>fastify.preParsingHookHandler&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>, <a href=#fastifyrequestgenericinterface>RequestGeneric</a>, <a href=#ContextConfigGeneric>ContextConfig</a>&gt;(request: <a href=#fastifyfastifyrequestrawserver-rawrequest-requestgeneric>FastifyRequest</a>, reply: <a href=#fastifyfastifyreplyrawserver-rawreply-contextconfig>FastifyReply</a>, done: (err?: <a href=#fastifyfastifyerror>FastifyError</a>) =&gt; void): Promise&lt;unknown&gt; | void</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/hooks.d.ts#L35>src</a></p><p><code>preParsing</code> is the second hook to be executed in the request lifecycle. The previous hook was <code>onRequest</code>, the next hook will be <code>preValidation</code>.</p><p>Notice: in the <code>preParsing</code> hook, request.body will always be null, because the body parsing happens before the <code>preValidation</code> hook.</p><p>Notice: you should also add <code>receivedEncodedLength</code> property to the returned stream. This property is used to correctly match the request payload with the <code>Content-Length</code> header value. Ideally, this property should be updated on each received chunk.</p><h5 id=fastifyprevalidationhookhandlerrawserver-rawrequest-rawreply-requestgeneric-contextconfigrequest-fastifyrequest-reply-fastifyreply-done-err-fastifyerror--void-promiseunknown--void>fastify.preValidationHookHandler&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>, <a href=#fastifyrequestgenericinterface>RequestGeneric</a>, <a href=#ContextConfigGeneric>ContextConfig</a>&gt;(request: <a href=#fastifyfastifyrequestrawserver-rawrequest-requestgeneric>FastifyRequest</a>, reply: <a href=#fastifyfastifyreplyrawserver-rawreply-contextconfig>FastifyReply</a>, done: (err?: <a href=#fastifyfastifyerror>FastifyError</a>) =&gt; void): Promise&lt;unknown&gt; | void</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/hooks.d.ts#L53>src</a></p><p><code>preValidation</code> is the third hook to be executed in the request lifecycle. The previous hook was <code>preParsing</code>, the next hook will be <code>preHandler</code>.</p><h5 id=fastifyprehandlerhookhandlerrawserver-rawrequest-rawreply-requestgeneric-contextconfigrequest-fastifyrequest-reply-fastifyreply-done-err-fastifyerror--void-promiseunknown--void>fastify.preHandlerHookHandler&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>, <a href=#fastifyrequestgenericinterface>RequestGeneric</a>, <a href=#ContextConfigGeneric>ContextConfig</a>&gt;(request: <a href=#fastifyfastifyrequestrawserver-rawrequest-requestgeneric>FastifyRequest</a>, reply: <a href=#fastifyfastifyreplyrawserver-rawreply-contextconfig>FastifyReply</a>, done: (err?: <a href=#fastifyfastifyerror>FastifyError</a>) =&gt; void): Promise&lt;unknown&gt; | void</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/hooks.d.ts#L70>src</a></p><p><code>preHandler</code> is the fourth hook to be executed in the request lifecycle. The previous hook was <code>preValidation</code>, the next hook will be <code>preSerialization</code>.</p><h5 id=fastifypreserializationhookhandlerpreserializationpayload-rawserver-rawrequest-rawreply-requestgeneric-contextconfigrequest-fastifyrequest-reply-fastifyreply-payload-preserializationpayload-done-err-fastifyerror--null-res-unknown--void-promiseunknown--void>fastify.preSerializationHookHandler&lt;PreSerializationPayload, <a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>, <a href=#fastifyrequestgenericinterface>RequestGeneric</a>, <a href=#ContextConfigGeneric>ContextConfig</a>&gt;(request: <a href=#fastifyfastifyrequestrawserver-rawrequest-requestgeneric>FastifyRequest</a>, reply: <a href=#fastifyfastifyreplyrawserver-rawreply-contextconfig>FastifyReply</a>, payload: PreSerializationPayload, done: (err: <a href=#fastifyfastifyerror>FastifyError</a> | null, res?: unknown) =&gt; void): Promise&lt;unknown&gt; | void</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/hooks.d.ts#L94>src</a></p><p><code>preSerialization</code> is the fifth hook to be executed in the request lifecycle. The previous hook was <code>preHandler</code>, the next hook will be <code>onSend</code>.</p><p>Note: the hook is NOT called if the payload is a string, a Buffer, a stream or null.</p><h5 id=fastifyonsendhookhandleronsendpayload-rawserver-rawrequest-rawreply-requestgeneric-contextconfigrequest-fastifyrequest-reply-fastifyreply-payload-onsendpayload-done-err-fastifyerror--null-res-unknown--void-promiseunknown--void>fastify.onSendHookHandler&lt;OnSendPayload, <a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>, <a href=#fastifyrequestgenericinterface>RequestGeneric</a>, <a href=#ContextConfigGeneric>ContextConfig</a>&gt;(request: <a href=#fastifyfastifyrequestrawserver-rawrequest-requestgeneric>FastifyRequest</a>, reply: <a href=#fastifyfastifyreplyrawserver-rawreply-contextconfig>FastifyReply</a>, payload: OnSendPayload, done: (err: <a href=#fastifyfastifyerror>FastifyError</a> | null, res?: unknown) =&gt; void): Promise&lt;unknown&gt; | void</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/hooks.d.ts#L114>src</a></p><p>You can change the payload with the <code>onSend</code> hook. It is the sixth hook to be executed in the request lifecycle. The previous hook was <code>preSerialization</code>, the next hook will be <code>onResponse</code>.</p><p>Note: If you change the payload, you may only change it to a string, a Buffer, a stream, or null.</p><h5 id=fastifyonresponsehookhandlerrawserver-rawrequest-rawreply-requestgeneric-contextconfigrequest-fastifyrequest-reply-fastifyreply-done-err-fastifyerror--void-promiseunknown--void>fastify.onResponseHookHandler&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>, <a href=#fastifyrequestgenericinterface>RequestGeneric</a>, <a href=#ContextConfigGeneric>ContextConfig</a>&gt;(request: <a href=#fastifyfastifyrequestrawserver-rawrequest-requestgeneric>FastifyRequest</a>, reply: <a href=#fastifyfastifyreplyrawserver-rawreply-contextconfig>FastifyReply</a>, done: (err?: <a href=#fastifyfastifyerror>FastifyError</a>) =&gt; void): Promise&lt;unknown&gt; | void</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/hooks.d.ts#L134>src</a></p><p><code>onResponse</code> is the seventh and last hook in the request hook lifecycle. The previous hook was <code>onSend</code>, there is no next hook.</p><p>The onResponse hook is executed when a response has been sent, so you will not be able to send more data to the client. It can however be useful for sending data to external services, for example to gather statistics.</p><h5 id=fastifyonerrorhookhandlerrawserver-rawrequest-rawreply-requestgeneric-contextconfigrequest-fastifyrequest-reply-fastifyreply-error-fastifyerror-done---void-promiseunknown--void>fastify.onErrorHookHandler&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>, <a href=#fastifyrequestgenericinterface>RequestGeneric</a>, <a href=#ContextConfigGeneric>ContextConfig</a>&gt;(request: <a href=#fastifyfastifyrequestrawserver-rawrequest-requestgeneric>FastifyRequest</a>, reply: <a href=#fastifyfastifyreplyrawserver-rawreply-contextconfig>FastifyReply</a>, error: <a href=#fastifyfastifyerror>FastifyError</a>, done: () =&gt; void): Promise&lt;unknown&gt; | void</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/hooks.d.ts#L154>src</a></p><p>This hook is useful if you need to do some custom error logging or add some specific header in case of error.</p><p>It is not intended for changing the error, and calling reply.send will throw an exception.</p><p>This hook will be executed only after the customErrorHandler has been executed, and only if the customErrorHandler sends an error back to the user (Note that the default customErrorHandler always sends the error back to the user).</p><p>Notice: unlike the other hooks, pass an error to the done function is not supported.</p><h5 id=fastifyonroutehookhandlerrawserver-rawrequest-rawreply-requestgeneric-contextconfigopts-routeoptions---path-string-prefix-string--promiseunknown--void>fastify.onRouteHookHandler&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>, <a href=#fastifyrequestgenericinterface>RequestGeneric</a>, <a href=#ContextConfigGeneric>ContextConfig</a>&gt;(opts: <a href=#fastifyrouteoptionsrawserver-rawrequest-rawreply-requestgeneric-contextconfig>RouteOptions</a> &amp; { path: string; prefix: string }): Promise&lt;unknown&gt; | void</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/hooks.d.ts#L174>src</a></p><p>Triggered when a new route is registered. Listeners are passed a routeOptions object as the sole parameter. The interface is synchronous, and, as such, the listener does not get passed a callback</p><h5 id=fastifyonregisterhookhandlerrawserver-rawrequest-rawreply-loggerinstance-fastifyinstance-done-err-fastifyerror--void-promiseunknown--void>fastify.onRegisterHookHandler&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>, <a href=#logger>Logger</a>&gt;(instance: <a href=#fastifyfastifyinstance>FastifyInstance</a>, done: (err?: <a href=#fastifyfastifyerror>FastifyError</a>) =&gt; void): Promise&lt;unknown&gt; | void</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/hooks.d.ts#L191>src</a></p><p>Triggered when a new plugin is registered and a new encapsulation context is created. The hook will be executed before the registered code.</p><p>This hook can be useful if you are developing a plugin that needs to know when a plugin context is formed, and you want to operate in that specific context.</p><p>Note: This hook will not be called if a plugin is wrapped inside fastify-plugin.</p><h5 id=fastifyonclosehookhandlerrawserver-rawrequest-rawreply-loggerinstance-fastifyinstance-done-err-fastifyerror--void-promiseunknown--void>fastify.onCloseHookHandler&lt;<a href=#rawserver>RawServer</a>, <a href=#rawrequest>RawRequest</a>, <a href=#rawreply>RawReply</a>, <a href=#logger>Logger</a>&gt;(instance: <a href=#fastifyfastifyinstance>FastifyInstance</a>, done: (err?: <a href=#fastifyfastifyerror>FastifyError</a>) =&gt; void): Promise&lt;unknown&gt; | void</h5><p><a href=https://github.com/fastify/fastify/blob/main/types/hooks.d.ts#L206>src</a></p><p>Triggered when fastify.close() is invoked to stop the server. It is useful when plugins need a &quot;shutdown&quot; event, for example to close an open connection to a database.</p></div><hr><nav class=level></nav></div></div></div></section><script>// dynamically creates a submenu for the current section based on the content headers
  var titles = document.querySelectorAll('#doc-content h3, #doc-content h4')
  var currentMenu = document.getElementById('doc-menu-section')
  if (titles.length && currentMenu) {
    var submenu = document.createElement('ul')
    titles.forEach(el => {
      var currentSubmenuItem = document.createElement('li')
      var currentSubmenuLink = document.createElement('a')
      currentSubmenuLink.href = '#' + el.id
      currentSubmenuLink.title = el.textContent
      currentSubmenuLink.append(document.createTextNode(el.textContent))
      currentSubmenuItem.append(currentSubmenuLink)
      submenu.append(currentSubmenuItem)
    })
    currentMenu.append(submenu)
  }

  // dynamically creates header anchor links
  var headers = document.querySelectorAll('#doc-content h3, #doc-content h4')
  headers.forEach(el => {
    var currentAnchorLink = document.createElement('a')
    currentAnchorLink.className = 'anchor'
    currentAnchorLink.href = "#" + el.id
    currentAnchorLink.append(document.createTextNode('¶'))
    el.insertBefore(currentAnchorLink, el.firstChild);
  })</script><script>const contentLoaded = document.addEventListener('DOMContentLoaded', setTOCHeight)
  const resize = window.addEventListener('resize', setTOCHeight)

  function setTOCHeight() {
    const docHeight = window.innerHeight
    const tocSidebar = document.querySelector('#toc') || 0

    const tocHeight = docHeight - tocSidebar.getBoundingClientRect().top

    document.documentElement.style
      .setProperty('--TOC-height', `${tocHeight}px`)
  }

  window.addEventListener('beforeunload', () => {
    document.removeEventListener(contentLoaded)
    window.removeEventListener(resize)
  })</script></main><footer class="grey is-primary footer"><div class=container><div class="content has-text-centered"><p>Fastify, Copyright &copy; 2016-2023 <a href=https://openjsf.org/ target=_blank rel=noopener>OpenJS Foundation</a> and <a href=https://github.com/fastify/fastify#team target=_blank rel=noopener>The Fastify team</a>, Licensed under <a href=https://github.com/fastify/fastify/blob/master/LICENSE target=_blank rel=noopener>MIT</a></p><a href=https://www.netlify.com><img src=https://www.netlify.com/img/global/badges/netlify-color-accent.svg alt="Deploys by Netlify" loading=lazy decoding=async></a><p><small>Icons by simpleicons.org</small></p></div></div></footer><script src=/js/main.1e1d476db6c0b326.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js integrity="sha512-s+tOYYcC3Jybgr9mVsdAxsRYlGNq4mlAurOrfNuGMQ/SCofNPu92tjE7YRZCsdEtWL1yGkqk15fU/ark206YTg==" crossorigin=anonymous></script><script>hljs.highlightAll();</script><script src=https://cdn.jsdelivr.net/npm/@docsearch/js@alpha></script><script type=text/javascript>docsearch({
        appId: 'DMPMC33PLU',
        apiKey: '12d46b3bfeee6511031cfe00778f3e45',
        indexName: 'fastify',
        container: '#algolia-search-input',
        algoliaOptions: { 'facetFilters': ["version:latest", "tags:docs"] }
      });</script></body></html>
<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>TypeScript and types support</title>
  <meta name="description" content="Fast and low overhead web framework, for Node.js">

  <link rel="apple-touch-icon" sizes="57x57" href="/images/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/images/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/images/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/images/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/images/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/images/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/images/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/images/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/images/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.5.1/css/bulma.min.css" integrity="sha256-CDVQJfU+jJGU/oyDzvnzuGXbv0rz+SyBsPQwyn7x/jQ=" crossorigin="anonymous" />
  <link rel="stylesheet" href="/css/style.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" integrity="sha256-Zd1icfZ72UBmsId/mUcagrmN7IN5Qkrvh75ICHIQVTk=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" crossorigin="anonymous" />

  

  
</head>


  <body>
    <nav id="main-navbar" class="navbar">
  <div class="navbar-brand">
    <a class="navbar-item" href="/">
      <img src="/images/fastify-logo-menu.png" alt="Fastify: Fast and low overhead web framework, for Node.js" height="28">
    </a>

    <a class="navbar-item is-hidden-desktop" href="https://github.com/fastify/fastify" target="_blank">
      <span class="icon" style="color: #333;">
        <i class="fa fa-github"></i>
      </span>
    </a>

    <div class="navbar-burger burger" data-target="mobileMenu">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>

  <div class="navbar-menu" id="mobileMenu">
    <div class="navbar-start">
      <a class="navbar-item " href="/">Home</a>
      <a class="navbar-item " href="/docs/latest">Docs</a>
      <a class="navbar-item " href="/ecosystem">Ecosystem</a>
      <a class="navbar-item " href="/benchmarks">Benchmarks</a>
      <a class="navbar-item " href="https://github.com/fastify/help">Help</a>
    </div>

    <div class="navbar-end">
      <span class="control has-icons-left navbar-item">
        <input id="algolia-search-input" class="input" type="search" placeholder="">
        <span class="icon is-medium is-left">
          <i class="fa fa-search"></i>
        </span>
      </span>

      <a class="navbar-item" href="https://github.com/fastify/fastify" target="_blank">
        <span class="fa fa-github"> </span>&nbsp;Github
      </a>
      <a class="navbar-item" href="https://twitter.com/fastifyjs" target="_blank">
        <span class="fa fa-twitter"> </span>&nbsp;Twitter
      </a>
    </div>
  </div>
</nav>


    <main class="page-content" aria-label="Content">
      
<section class="hero is-primary" style="background-image: url('/images/bg-pattern-dark.png')">
  <div class="hero-body">
      <div class="container">
        <h1 class="title">
          Documentation
        </h1>
      </div>
  </div>
</section>

<div class="container">
  <section class="section">
    <div class="columns">

      <div class="column is-3 is-hidden-mobile" data-sticky-container>
        <aside class="menu sticky">
          <p class="menu-label">
            Table of contents
          </p>
          <ul class="menu-list">
            
              <li >
                <a  href="/docs/v1.9.x/Getting-Started">Getting Started</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/Server-Methods">Server Methods</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/Routes">Routes</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/Logging">Logging</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/Middlewares">Middlewares</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/Hooks">Hooks</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/Decorators">Decorators</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/Validation-and-Serialization">Validation and Serialization</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/Lifecycle">Lifecycle</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/Reply">Reply</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/Request">Request</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/ContentTypeParser">Content Type Parser</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/Factory">Factory</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/Plugins">Plugins</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/Testing">Testing</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/Benchmarking">Benchmarking</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/Write-Plugin">How to write a good plugin</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/Plugins-Guide">Plugins Guide</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/HTTP2">HTTP2</a>
              </li>
            
              <li >
                <a  href="/docs/v1.9.x/LTS">Long Term Support</a>
              </li>
            
              <li id="doc-menu-section">
                <a class="is-active" href="/docs/v1.9.x/TypeScript">TypeScript and types support</a>
              </li>
            
          </ul>
          <div class="content" style="margin: .8em; border-top: 1px solid #ccc; padding: .8em 0 0 0">
            Docs version
            <div class="field">
              <div class="control">
                <div class="select">
                  <select onchange="if (this.value) window.location.href=this.value">
                    
                      
                        
                        
                          <option  value="/docs/master">master</option>
                      
                    
                      
                        
                        
                          
                        
                          <option  value="/docs/v1.11.x">v1.11.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v1.10.x">v1.10.x</option>
                      
                    
                      
                        
                        
                          <option selected="selected" value="/docs/v1.9.x">v1.9.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v1.8.x">v1.8.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v1.7.x">v1.7.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v1.6.x">v1.6.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v1.5.x">v1.5.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v1.4.x">v1.4.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v1.3.x">v1.3.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v1.2.x">v1.2.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v1.1.x">v1.1.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v1.0.x">v1.0.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.43.x">v0.43.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.42.x">v0.42.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.41.x">v0.41.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.40.x">v0.40.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.39.x">v0.39.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.38.x">v0.38.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.37.x">v0.37.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.36.x">v0.36.x</option>
                      
                    
                      
                        
                        
                          <option  value="/docs/v0.35.x">v0.35.x</option>
                      
                    
                      
                    
                  </select>
                </div>
              </div>
            </div>
          </div>
        </aside>
      </div>

      <div class="column">
        <nav class="breadcrumb">
          <ul>
            <li><a href="/" style="padding-left: 0">Fastify</a></li>
            <li><a href="/docs/">Documentation</a></li>
            <li>
              <div class="field">
                <div class="control">
                  <div class="select">
                    <select onchange="if (this.value) window.location.href=this.value" style="border: none;">
                      
                        
                          
                          <option  value="/docs/master">master</option>
                        
                      
                        
                          
                          <option  value="/docs/v1.11.x">v1.11.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v1.10.x">v1.10.x</option>
                        
                      
                        
                          
                          <option selected="selected" value="/docs/v1.9.x">v1.9.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v1.8.x">v1.8.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v1.7.x">v1.7.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v1.6.x">v1.6.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v1.5.x">v1.5.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v1.4.x">v1.4.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v1.3.x">v1.3.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v1.2.x">v1.2.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v1.1.x">v1.1.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v1.0.x">v1.0.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.43.x">v0.43.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.42.x">v0.42.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.41.x">v0.41.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.40.x">v0.40.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.39.x">v0.39.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.38.x">v0.38.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.37.x">v0.37.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.36.x">v0.36.x</option>
                        
                      
                        
                          
                          <option  value="/docs/v0.35.x">v0.35.x</option>
                        
                      
                        
                      
                    </select>
                  </div>
                </div>
              </div>
            </li>
            <li class="is-active"><a>TypeScript and types support</a></li>
          </ul>
        </nav>

        <div id="doc-content" class="content">
          <p><a id="typescript"></a></p>
<h2 id="typescript">TypeScript</h2>
<p>Fastify is shipped with the a typings file, but it still require to install <code>@types/node</code>, depending on the Node.js version that you are using.</p>
<h2 id="types-support">Types support</h2>
<p>We do care about the TypeScript community, but the framework is written in plain JavaScript and currently no one of the core team is a TypeScript user while only one of the collaborators is.
We do our best to have the typing updated with the latest version of the API, but <em>it can happen</em> that the typings are not in sync.<br/>
Luckly this is Open Source and you can contribute to fix them, we will be very happy to accept the fix and release it as soon as possible as a patch release. Checkout the <a href="#contributing">contributing</a> rules!</p>
<p>Plugins may or may not include typings. See <a href="#plugin-types">Plugin Types</a> for more information.</p>
<h2 id="example">Example</h2>
<p>This example TypeScript app closely aligns with the JavaScript examples:</p>
<pre><code class="lang-ts">import * as fastify from &#39;fastify&#39;
import { Server, IncomingMessage, ServerResponse } from &#39;http&#39;

// Create a http server. We pass the relevant typings for our http version used.
// By passing types we get correctly typed access to the underlying http objects in routes.
// If using http we&#39;d pass &lt;http2.Http2Server, http2.Http2ServerRequest, http2.Http2ServerResponse&gt;
const server: fastify.FastifyInstance&lt;Server, IncomingMessage, ServerResponse&gt; = fastify({})

const opts: fastify.RouteShorthandOptions = {
  schema: {
    response: {
      200: {
        type: &#39;object&#39;,
        properties: {
          pong: {
            type: &#39;string&#39;
          }
        }
      }
    }
  }
}

server.get(&#39;/ping&#39;, opts, (request, reply) =&gt; {
  console.log(reply.res) // this is the http.ServerResponse with correct typings!
  reply.code(200).send({ pong: &#39;it worked!&#39; })
})
</code></pre>
<p><a id="http-prototypes"></a></p>
<h2 id="http-prototypes">HTTP Prototypes</h2>
<p>By default, fastify will determine which version of http is being used based on the options you pass to it. If for any
reason you need to override this you can do so as shown below:</p>
<pre><code class="lang-ts">interface CustomIncomingMessage extends http.IncomingMessage {
  getClientDeviceType: () =&gt; string
}

// Passing overrides for the http prototypes to fastify
const server: fastify.FastifyInstance&lt;http.Server, CustomIncomingMessage, http.ServerResponse&gt; = fastify()

server.get(&#39;/ping&#39;, (request, reply) =&gt; {
  // Access our custom method on the http prototype
  const clientDeviceType = request.raw.getClientDeviceType()

  reply.send({ clientDeviceType: `you called this endpoint from a ${clientDeviceType}` })
})
</code></pre>
<p>In this example we pass a modified <code>http.IncomingMessage</code> interface since it has been extended elsewhere in our
application.</p>
<p><a id="contributing"></a></p>
<h2 id="contributing">Contributing</h2>
<p>TypeScript related changes can be considered to fall into one of two categories:</p>
<ul>
<li>Core - The typings bundled with fastify</li>
<li>Plugins - Fastify ecosystem plugins</li>
</ul>
<p>Make sure to read our <code>CONTRIBUTING.md</code> file before getting started to make sure things go smoothly!</p>
<p><a id="core-types"></a></p>
<h3 id="core-types">Core Types</h3>
<p>When updating core types you should make a PR to this repository. Ensure you:</p>
<ol>
<li>Update <code>examples/typescript-server.ts</code> to reflect the changes (if necessary)</li>
<li>Update <code>test/types/index.ts</code> to validate changes work as expected</li>
</ol>
<p><a id="plugin-types"></a></p>
<h3 id="plugin-types">Plugin Types</h3>
<p>Typings for plugins are hosted in DefinitelyTyped. This means when using plugins you should install like so:</p>
<pre><code>npm install fastify-url-data @types/fastify-url-data
</code></pre><p>After this you should be good to go. Some types might not be available yet, so don&#39;t be shy about contributing.</p>
<p><a id="authoring-plugin-types"></a></p>
<h3 id="authoring-plugin-types">Authoring Plugin Types</h3>
<p>Typings for many plugins that extend the <code>FastifyRequest</code> and <code>FastifyReply</code> objects can be achieved as shown below.</p>
<p>This code demonstrates adding types for <code>fastify-url-data</code> to your application.</p>
<pre><code class="lang-ts">// filename: custom-types.d.ts

// Core typings and values
import fastify = require(&#39;fastify&#39;);

// Extra types that will be used for plugin typings
import { UrlObject } from &#39;url&#39;;

// Extend FastifyReply with the &quot;fastify-url-data&quot; plugin
declare module &#39;fastify&#39; {
  interface FastifyRequest {
    urlData (): UrlObject
  }
}

declare function urlData (): void

declare namespace urlData {}

export = urlData;
</code></pre>
<p>Now you can use <code>fastify-url-data</code> like so:</p>
<pre><code class="lang-ts">import * as fastify from &#39;fastify&#39;
import * as urlData from &#39;fastify-url-data&#39;

/// &lt;reference types=&quot;./custom-types.d.ts&quot;/&gt;

const server = fastify();

server.register(urlData)

server.get(&#39;/data&#39;, (request, reply) =&gt; {
  console.log(request.urlData().auth)
  console.log(request.urlData().host)
  console.log(request.urlData().port)
  console.log(request.urlData().query)

  reply.send({msg: &#39;ok&#39;})
})

server.listen(3030)
</code></pre>
<p>Remember, if you author typings for a plugin you should publish them to DefinitelyTyped!</p>

        </div>

        <hr/>
        <nav class="level">
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
            <div class="level-left">
              <div class="level-item">
                
                  
                  
                  <a href="/docs/v1.9.x/LTS" class="button prev">≪ Long Term Support</a>
                
              </div>
            </div>
            <div class="level-right">
              <div class="level-item">
                
                  &nbsp;
                
              </div>
            </div>
          
        
        </nav>
      </div>
    </div>
  </section>

  <script>
    // dynamically creates a submenu for the current section based on the content headers
    var titles = document.querySelectorAll('#doc-content h3, #doc-content h4')
    var currentMenu = document.getElementById('doc-menu-section')
    if (titles.length && currentMenu) {
      var submenu = document.createElement('ul')
      titles.forEach(el => {
        var currentSubmenuItem = document.createElement('li')
        var currentSubmenuLink = document.createElement('a')
        currentSubmenuLink.href = '#' + el.id
        currentSubmenuLink.append(document.createTextNode(el.textContent))
        currentSubmenuItem.append(currentSubmenuLink)
        submenu.append(currentSubmenuItem)
      })
      currentMenu.append(submenu)
    }

    // dynamically creates header anchor links
    var headers = document.querySelectorAll('#doc-content h3, #doc-content h4')
    headers.forEach(el => {
      var currentAnchorLink = document.createElement('a')
      currentAnchorLink.className = 'anchor'
      currentAnchorLink.href = "#" + el.id
      currentAnchorLink.append(document.createTextNode('¶'))
      el.insertBefore(currentAnchorLink, el.firstChild);
    })
  </script>
</div>

    </main>

    <footer class="grey is-primary footer">
  <div class="container">
    <div class="content has-text-centered">
    
      <p>Fastify, Copyright &copy; 2016-2018 <a href="https://github.com/fastify/fastify#team" target="_blank">The Fastify team</a>, Licensed under <a href="https://github.com/fastify/fastify/blob/master/LICENSE" target="_blank">MIT</a></p>
    </div>
  </div>
</footer>


    <script src="/js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
    <script type="text/javascript">
      docsearch({
        apiKey: 'f7c62ddab40e653f67a6e15be761d951',
        indexName: 'fastify',
        inputSelector: '#algolia-search-input',
        algoliaOptions: { 'facetFilters': ["version:latest", "tags:docs"] },
        debug: false // Set debug to true if you want to inspect the dropdown
      });
    </script>
  </body>

</html>
